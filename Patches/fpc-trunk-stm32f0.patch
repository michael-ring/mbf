diff -Naur fpc-save/compiler/arm/cpuinfo.pas fpc-build/compiler/arm/cpuinfo.pas
--- fpc-save/compiler/arm/cpuinfo.pas	2018-03-02 16:27:52.000000000 +0100
+++ fpc-build/compiler/arm/cpuinfo.pas	2018-03-02 16:36:57.000000000 +0100
@@ -186,19 +186,40 @@
       ct_at91sam7xc256,
 
       { STMicroelectronics }
+      { STMicroelectronics F0 }
       ct_stm32f030c6,
       ct_stm32f030c8,
+      ct_stm32f030cc,
       ct_stm32f030f4,
       ct_stm32f030k6,
       ct_stm32f030r8,
-      ct_stm32f050c4,
-      ct_stm32f050c6,
-      ct_stm32f050f4,
-      ct_stm32f050f6,
-      ct_stm32f050g4,
-      ct_stm32f050g6,
-      ct_stm32f050k4,
-      ct_stm32f050k6,
+      ct_stm32f030rc,
+      ct_stm32f031c4,
+      ct_stm32f031c6,
+      ct_stm32f031e6,
+      ct_stm32f031f4,
+      ct_stm32f031f6,
+      ct_stm32f031g4,
+      ct_stm32f031g6,
+      ct_stm32f031k4,
+      ct_stm32f031k6,
+      ct_stm32f038c6,
+      ct_stm32f038e6,
+      ct_stm32f038f6,
+      ct_stm32f038g6,
+      ct_stm32f038k6,
+      ct_stm32f042c4,
+      ct_stm32f042c6,
+      ct_stm32f042f4,
+      ct_stm32f042f6,
+      ct_stm32f042g4,
+      ct_stm32f042g6,
+      ct_stm32f042k4,
+      ct_stm32f042k6,
+      ct_stm32f042t6,
+      ct_stm32f048c6,
+      ct_stm32f048g6,
+      ct_stm32f048t6,
       ct_stm32f051c4,
       ct_stm32f051c6,
       ct_stm32f051c8,
@@ -208,12 +229,47 @@
       ct_stm32f051r4,
       ct_stm32f051r6,
       ct_stm32f051r8,
-      ct_stm32f091cc,
+      ct_stm32f051t8,
+      ct_stm32f058c8,
+      ct_stm32f058r8,
+      ct_stm32f058t8,
+      ct_stm32f070c6,
+      ct_stm32f070cb,
+      ct_stm32f070f6,
+      ct_stm32f070rb,
+      ct_stm32f071c8,
+      ct_stm32f071cb,
+      ct_stm32f071rb,
+      ct_stm32f071v8,
+      ct_stm32f071vb,
+      ct_stm32f072c8,
+      ct_stm32f072cb,
+      ct_stm32f072r8,
+      ct_stm32f072rb,
+      ct_stm32f072v8,
+      ct_stm32f072vb,
+      ct_stm32f078cb,
+      ct_stm32f078rb,
+      ct_stm32f078vb,
       ct_stm32f091cb,
-      ct_stm32f091rc,
+      ct_stm32f091cc,
       ct_stm32f091rb,
-      ct_stm32f091vc,
+      ct_stm32f091rc,
       ct_stm32f091vb,
+      ct_stm32f091vc,
+      ct_stm32f098cc,
+      ct_stm32f098rc,
+      ct_stm32f098vc,
+      ct_nucleof031k6,
+      ct_nucleof042k6,
+      ct_nucleof030r8,
+      ct_nucleof070rb,
+      ct_nucleof072rb,
+      ct_nucleof091rc,
+      ct_stm32f0308discovery,
+      ct_stm32f072bdiscovery,
+      ct_stm32f0discovery,
+
       ct_stm32f100x4, // LD&MD value line, 4=16,6=32,8=64,b=128
       ct_stm32f100x6,
       ct_stm32f100x8,
@@ -698,35 +754,89 @@
       (controllertypestr:'AT91SAM7X256';	controllerunitstr:'AT91SAM7x256';	cputype:cpu_armv4t; fputype:fpu_soft; flashbase:$00000000;	flashsize:$00040000;	srambase:$00200000;	sramsize:$00010000),
       (controllertypestr:'AT91SAM7XC256';	controllerunitstr:'AT91SAM7x256';	cputype:cpu_armv4t; fputype:fpu_soft; flashbase:$00000000;	flashsize:$00040000;	srambase:$00200000;	sramsize:$00010000),
 
-      { STM32F0 series }
-      (controllertypestr:'STM32F030C6';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F030C8';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
-      (controllertypestr:'STM32F030F4';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00004000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F030K6';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F030R8';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
-      (controllertypestr:'STM32F050C4';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00004000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F050C6';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F050F4';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00004000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F050F6';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F050G4';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00004000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F050G6';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F050K4';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00004000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F050K6';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F051C4';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00004000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F051C6';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F051C8';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
-      (controllertypestr:'STM32F051K4';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00004000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F051K6';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F051K8';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
-      (controllertypestr:'STM32F051R4';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00004000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F051R6';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
-      (controllertypestr:'STM32F051R8';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
-      (controllertypestr:'STM32F091CC';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00040000; srambase:$20000000; sramsize:$00008000),
-      (controllertypestr:'STM32F091CB';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00008000),
-      (controllertypestr:'STM32F091RC';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00040000; srambase:$20000000; sramsize:$00008000),
-      (controllertypestr:'STM32F091RB';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00008000),
-      (controllertypestr:'STM32F091VC';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00040000; srambase:$20000000; sramsize:$00008000),
-      (controllertypestr:'STM32F091VB';     controllerunitstr:'STM32F0XX';        cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00008000),
+      { STM32F0xx Family }
+      (controllertypestr:'STM32F030C6'         ;controllerunitstr:'STM32F030X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F030C8'         ;controllerunitstr:'STM32F030X8'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F030CC'         ;controllerunitstr:'STM32F030XC'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00040000; srambase:$20000000; sramsize:$00008000),
+      (controllertypestr:'STM32F030F4'         ;controllerunitstr:'STM32F030X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F030K6'         ;controllerunitstr:'STM32F030X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F030R8'         ;controllerunitstr:'STM32F030X8'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F030RC'         ;controllerunitstr:'STM32F030XC'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00040000; srambase:$20000000; sramsize:$00008000),
+      (controllertypestr:'STM32F031C4'         ;controllerunitstr:'STM32F031X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F031C6'         ;controllerunitstr:'STM32F031X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F031E6'         ;controllerunitstr:'STM32F031X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F031F4'         ;controllerunitstr:'STM32F031X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F031F6'         ;controllerunitstr:'STM32F031X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F031G4'         ;controllerunitstr:'STM32F031X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F031G6'         ;controllerunitstr:'STM32F031X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F031K4'         ;controllerunitstr:'STM32F031X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F031K6'         ;controllerunitstr:'STM32F031X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F038C6'         ;controllerunitstr:'STM32F038XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F038E6'         ;controllerunitstr:'STM32F038XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F038F6'         ;controllerunitstr:'STM32F038XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F038G6'         ;controllerunitstr:'STM32F038XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F038K6'         ;controllerunitstr:'STM32F038XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'STM32F042C4'         ;controllerunitstr:'STM32F042X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001800),
+      (controllertypestr:'STM32F042C6'         ;controllerunitstr:'STM32F042X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001800),
+      (controllertypestr:'STM32F042F4'         ;controllerunitstr:'STM32F042X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001800),
+      (controllertypestr:'STM32F042F6'         ;controllerunitstr:'STM32F042X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001800),
+      (controllertypestr:'STM32F042G4'         ;controllerunitstr:'STM32F042X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001800),
+      (controllertypestr:'STM32F042G6'         ;controllerunitstr:'STM32F042X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001800),
+      (controllertypestr:'STM32F042K4'         ;controllerunitstr:'STM32F042X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001800),
+      (controllertypestr:'STM32F042K6'         ;controllerunitstr:'STM32F042X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001800),
+      (controllertypestr:'STM32F042T6'         ;controllerunitstr:'STM32F042X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001800),
+      (controllertypestr:'STM32F048C6'         ;controllerunitstr:'STM32F048XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001800),
+      (controllertypestr:'STM32F048G6'         ;controllerunitstr:'STM32F048XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001800),
+      (controllertypestr:'STM32F048T6'         ;controllerunitstr:'STM32F048XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001800),
+      (controllertypestr:'STM32F051C4'         ;controllerunitstr:'STM32F051X8'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F051C6'         ;controllerunitstr:'STM32F051X8'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F051C8'         ;controllerunitstr:'STM32F051X8'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F051K4'         ;controllerunitstr:'STM32F051X8'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F051K6'         ;controllerunitstr:'STM32F051X8'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F051K8'         ;controllerunitstr:'STM32F051X8'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F051R4'         ;controllerunitstr:'STM32F051X8'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F051R6'         ;controllerunitstr:'STM32F051X8'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F051R8'         ;controllerunitstr:'STM32F051X8'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F051T8'         ;controllerunitstr:'STM32F051X8'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F058C8'         ;controllerunitstr:'STM32F058XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F058R8'         ;controllerunitstr:'STM32F058XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F058T8'         ;controllerunitstr:'STM32F058XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F070C6'         ;controllerunitstr:'STM32F070X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001800),
+      (controllertypestr:'STM32F070CB'         ;controllerunitstr:'STM32F070XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F070F6'         ;controllerunitstr:'STM32F070X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001800),
+      (controllertypestr:'STM32F070RB'         ;controllerunitstr:'STM32F070XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F071C8'         ;controllerunitstr:'STM32F071XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F071CB'         ;controllerunitstr:'STM32F071XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F071RB'         ;controllerunitstr:'STM32F071XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F071V8'         ;controllerunitstr:'STM32F071XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F071VB'         ;controllerunitstr:'STM32F071XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F072C8'         ;controllerunitstr:'STM32F072XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F072CB'         ;controllerunitstr:'STM32F072XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F072R8'         ;controllerunitstr:'STM32F072XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F072RB'         ;controllerunitstr:'STM32F072XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F072V8'         ;controllerunitstr:'STM32F072XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F072VB'         ;controllerunitstr:'STM32F072XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F078CB'         ;controllerunitstr:'STM32F078XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F078RB'         ;controllerunitstr:'STM32F078XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F078VB'         ;controllerunitstr:'STM32F078XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F091CB'         ;controllerunitstr:'STM32F091XC'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00040000; srambase:$20000000; sramsize:$00008000),
+      (controllertypestr:'STM32F091CC'         ;controllerunitstr:'STM32F091XC'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00040000; srambase:$20000000; sramsize:$00008000),
+      (controllertypestr:'STM32F091RB'         ;controllerunitstr:'STM32F091XC'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00040000; srambase:$20000000; sramsize:$00008000),
+      (controllertypestr:'STM32F091RC'         ;controllerunitstr:'STM32F091XC'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00040000; srambase:$20000000; sramsize:$00008000),
+      (controllertypestr:'STM32F091VB'         ;controllerunitstr:'STM32F091XC'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00040000; srambase:$20000000; sramsize:$00008000),
+      (controllertypestr:'STM32F091VC'         ;controllerunitstr:'STM32F091XC'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00040000; srambase:$20000000; sramsize:$00008000),
+      (controllertypestr:'STM32F098CC'         ;controllerunitstr:'STM32F098XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00040000; srambase:$20000000; sramsize:$00008000),
+      (controllertypestr:'STM32F098RC'         ;controllerunitstr:'STM32F098XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00040000; srambase:$20000000; sramsize:$00008000),
+      (controllertypestr:'STM32F098VC'         ;controllerunitstr:'STM32F098XX'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00040000; srambase:$20000000; sramsize:$00008000),
+      (controllertypestr:'NUCLEOF031K6'         ;controllerunitstr:'STM32F031X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001000),
+      (controllertypestr:'NUCLEOF042K6'         ;controllerunitstr:'STM32F042X6'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00008000; srambase:$20000000; sramsize:$00001800),
+      (controllertypestr:'NUCLEOF030R8'         ;controllerunitstr:'STM32F030X8'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'NUCLEOF070RB'         ;controllerunitstr:'STM32F070XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'NUCLEOF072RB'         ;controllerunitstr:'STM32F072XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'NUCLEOF091RC'         ;controllerunitstr:'STM32F091XC'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00040000; srambase:$20000000; sramsize:$00008000),
+      (controllertypestr:'STM32F0308DISCOVERY'         ;controllerunitstr:'STM32F030X8'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
+      (controllertypestr:'STM32F072BDISCOVERY'         ;controllerunitstr:'STM32F072XB'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00020000; srambase:$20000000; sramsize:$00004000),
+      (controllertypestr:'STM32F0DISCOVERY'         ;controllerunitstr:'STM32F051X8'  ; cputype:cpu_armv6m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00010000; srambase:$20000000; sramsize:$00002000),
 
       { STM32F1 series }
       (controllertypestr:'STM32F100X4';     controllerunitstr:'STM32F10X_LD';     cputype:cpu_armv7m; fputype:fpu_soft; flashbase:$08000000; flashsize:$00004000; srambase:$20000000; sramsize:$00001000),
diff -Naur fpc-save/compiler/systems/t_embed.pas fpc-build/compiler/systems/t_embed.pas
--- fpc-save/compiler/systems/t_embed.pas	2018-03-02 16:27:52.000000000 +0100
+++ fpc-build/compiler/systems/t_embed.pas	2018-03-02 16:35:05.000000000 +0100
@@ -336,19 +336,40 @@
       ct_at91sam7x256,
       ct_at91sam7xc256,
 
+      { STMicroelectronics F0 }
       ct_stm32f030c6,
       ct_stm32f030c8,
+      ct_stm32f030cc,
       ct_stm32f030f4,
       ct_stm32f030k6,
       ct_stm32f030r8,
-      ct_stm32f050c4,
-      ct_stm32f050c6,
-      ct_stm32f050f4,
-      ct_stm32f050f6,
-      ct_stm32f050g4,
-      ct_stm32f050g6,
-      ct_stm32f050k4,
-      ct_stm32f050k6,
+      ct_stm32f030rc,
+      ct_stm32f031c4,
+      ct_stm32f031c6,
+      ct_stm32f031e6,
+      ct_stm32f031f4,
+      ct_stm32f031f6,
+      ct_stm32f031g4,
+      ct_stm32f031g6,
+      ct_stm32f031k4,
+      ct_stm32f031k6,
+      ct_stm32f038c6,
+      ct_stm32f038e6,
+      ct_stm32f038f6,
+      ct_stm32f038g6,
+      ct_stm32f038k6,
+      ct_stm32f042c4,
+      ct_stm32f042c6,
+      ct_stm32f042f4,
+      ct_stm32f042f6,
+      ct_stm32f042g4,
+      ct_stm32f042g6,
+      ct_stm32f042k4,
+      ct_stm32f042k6,
+      ct_stm32f042t6,
+      ct_stm32f048c6,
+      ct_stm32f048g6,
+      ct_stm32f048t6,
       ct_stm32f051c4,
       ct_stm32f051c6,
       ct_stm32f051c8,
@@ -358,6 +379,46 @@
       ct_stm32f051r4,
       ct_stm32f051r6,
       ct_stm32f051r8,
+      ct_stm32f051t8,
+      ct_stm32f058c8,
+      ct_stm32f058r8,
+      ct_stm32f058t8,
+      ct_stm32f070c6,
+      ct_stm32f070cb,
+      ct_stm32f070f6,
+      ct_stm32f070rb,
+      ct_stm32f071c8,
+      ct_stm32f071cb,
+      ct_stm32f071rb,
+      ct_stm32f071v8,
+      ct_stm32f071vb,
+      ct_stm32f072c8,
+      ct_stm32f072cb,
+      ct_stm32f072r8,
+      ct_stm32f072rb,
+      ct_stm32f072v8,
+      ct_stm32f072vb,
+      ct_stm32f078cb,
+      ct_stm32f078rb,
+      ct_stm32f078vb,
+      ct_stm32f091cb,
+      ct_stm32f091cc,
+      ct_stm32f091rb,
+      ct_stm32f091rc,
+      ct_stm32f091vb,
+      ct_stm32f091vc,
+      ct_stm32f098cc,
+      ct_stm32f098rc,
+      ct_stm32f098vc,
+      ct_nucleof031k6,
+      ct_nucleof042k6,
+      ct_nucleof030r8,
+      ct_nucleof070rb,
+      ct_nucleof072rb,
+      ct_nucleof091rc,
+      ct_stm32f0308discovery,
+      ct_stm32f072bdiscovery,
+      ct_stm32f0discovery,
 
       ct_stm32f100x4,
       ct_stm32f100x6,
diff -Naur fpc-save/rtl/embedded/Makefile fpc-build/rtl/embedded/Makefile
--- fpc-save/rtl/embedded/Makefile	2018-03-02 16:27:52.000000000 +0100
+++ fpc-build/rtl/embedded/Makefile	2018-03-02 16:33:48.000000000 +0100
@@ -374,7 +374,9 @@
 CPU_UNITS_DEFINED=1
 endif
 ifeq ($(SUBARCH),armv6m)
-CPU_UNITS=lpc8xx lpc11xx lpc122x stm32f0xx nrf51 cortexm0
+CPU_UNITS=lpc8xx lpc11xx lpc122x nrf51 cortexm0
+CPU_UNITS+=stm32f030x6 stm32f030x8 stm32f030xc stm32f031x6 stm32f038xx stm32f042x6 stm32f048xx stm32f051x8 stm32f058xx stm32f070x6
+CPU_UNITS+=stm32f070xb stm32f071xb stm32f072xb stm32f078xx stm32f091xc stm32f098xx
 CPU_UNITS_DEFINED=1
 endif
 ifeq ($(SUBARCH),armv7a)
diff -Naur fpc-save/rtl/embedded/Makefile.fpc fpc-build/rtl/embedded/Makefile.fpc
--- fpc-save/rtl/embedded/Makefile.fpc	2018-03-02 16:27:52.000000000 +0100
+++ fpc-build/rtl/embedded/Makefile.fpc	2018-03-02 16:37:47.000000000 +0100
@@ -87,7 +87,9 @@
 CPU_UNITS_DEFINED=1
 endif
 ifeq ($(SUBARCH),armv6m)
-CPU_UNITS=lpc8xx lpc11xx lpc122x stm32f0xx nrf51 cortexm0
+CPU_UNITS=lpc8xx lpc11xx lpc122x nrf51 cortexm0
+CPU_UNITS+=stm32f030x6 stm32f030x8 stm32f030xc stm32f031x6 stm32f038xx stm32f042x6 stm32f048xx stm32f051x8 stm32f058xx stm32f070x6
+CPU_UNITS+=stm32f070xb stm32f071xb stm32f072xb stm32f078xx stm32f091xc stm32f098xx
 CPU_UNITS_DEFINED=1
 endif
 ifeq ($(SUBARCH),armv7a)
diff -Naur fpc-save/rtl/embedded/arm/stm32f030x6.pp fpc-build/rtl/embedded/arm/stm32f030x6.pp
--- fpc-save/rtl/embedded/arm/stm32f030x6.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f030x6.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,509 @@
+unit stm32f030x6;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f030x6.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_IRQn   = 4,                   // RCC global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    DMA1_Channel1_IRQn = 9,           // DMA1 Channel 1 Interrupt
+    DMA1_Channel2_3_IRQn = 10,        // DMA1 Channel 2 and Channel 3 Interrupt
+    DMA1_Channel4_5_IRQn = 11,        // DMA1 Channel 4 and Channel 5 Interrupt
+    ADC1_IRQn  = 12,                  // ADC1 Interrupt
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    USART1_IRQn = 27                  // USART1 global Interrupt
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    RESERVED3  : longword;            // Reserved,                                                    0x14
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    RESERVED1  : longword;            // Reserved
+    RESERVED2  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED3  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOD_BASE   = AHB2PERIPH_BASE + $00000C00;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOD        : TGPIO_Registers absolute GPIOD_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_interrupt; external name 'RCC_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure DMA1_Channel1_interrupt; external name 'DMA1_Channel1_interrupt';
+procedure DMA1_Channel2_3_interrupt; external name 'DMA1_Channel2_3_interrupt';
+procedure DMA1_Channel4_5_interrupt; external name 'DMA1_Channel4_5_interrupt';
+procedure ADC1_interrupt; external name 'ADC1_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long 0
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long 0
+  .long DMA1_Channel1_interrupt
+  .long DMA1_Channel2_3_interrupt
+  .long DMA1_Channel4_5_interrupt
+  .long ADC1_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long 0
+  .long TIM3_interrupt
+  .long 0
+  .long 0
+  .long TIM14_interrupt
+  .long 0
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long 0
+  .long SPI1_interrupt
+  .long 0
+  .long USART1_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak DMA1_Channel1_interrupt
+  .weak DMA1_Channel2_3_interrupt
+  .weak DMA1_Channel4_5_interrupt
+  .weak ADC1_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM3_interrupt
+  .weak TIM14_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak SPI1_interrupt
+  .weak USART1_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set DMA1_Channel1_interrupt, HaltProc
+  .set DMA1_Channel2_3_interrupt, HaltProc
+  .set DMA1_Channel4_5_interrupt, HaltProc
+  .set ADC1_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .text
+end;
+end.
diff -Naur fpc-save/rtl/embedded/arm/stm32f030x8.pp fpc-build/rtl/embedded/arm/stm32f030x8.pp
--- fpc-save/rtl/embedded/arm/stm32f030x8.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f030x8.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,541 @@
+unit stm32f030x8;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f030x8.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_IRQn   = 4,                   // RCC global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    DMA1_Channel1_IRQn = 9,           // DMA1 Channel 1 Interrupt
+    DMA1_Channel2_3_IRQn = 10,        // DMA1 Channel 2 and Channel 3 Interrupt
+    DMA1_Channel4_5_IRQn = 11,        // DMA1 Channel 4 and Channel 5 Interrupt
+    ADC1_IRQn  = 12,                  // ADC1 Interrupt
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM6_IRQn  = 17,                  // TIM6 global Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM15_IRQn = 20,                  // TIM15 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt
+    I2C2_IRQn  = 24,                  // I2C2 Event Interrupt
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    SPI2_IRQn  = 26,                  // SPI2 global Interrupt
+    USART1_IRQn = 27,                 // USART1 global Interrupt
+    USART2_IRQn = 28                  // USART2 global Interrupt
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    RESERVED3  : longword;            // Reserved,                                                    0x14
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+    WRP1       : word;                // FLASH option byte write protection 1
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    RESERVED1  : longword;            // Reserved
+    RESERVED2  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED3  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM6_BASE    = APBPERIPH_BASE + $00001000;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  SPI2_BASE    = APBPERIPH_BASE + $00003800;
+  USART2_BASE  = APBPERIPH_BASE + $00004400;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  I2C2_BASE    = APBPERIPH_BASE + $00005800;
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM15_BASE   = APBPERIPH_BASE + $00014000;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOD_BASE   = AHB2PERIPH_BASE + $00000C00;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM6         : TTIM_Registers absolute TIM6_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  USART2       : TUSART_Registers absolute USART2_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  I2C2         : TI2C_Registers absolute I2C2_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  SPI2         : TSPI_Registers absolute SPI2_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM15        : TTIM_Registers absolute TIM15_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOD        : TGPIO_Registers absolute GPIOD_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_interrupt; external name 'RCC_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure DMA1_Channel1_interrupt; external name 'DMA1_Channel1_interrupt';
+procedure DMA1_Channel2_3_interrupt; external name 'DMA1_Channel2_3_interrupt';
+procedure DMA1_Channel4_5_interrupt; external name 'DMA1_Channel4_5_interrupt';
+procedure ADC1_interrupt; external name 'ADC1_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM6_interrupt; external name 'TIM6_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM15_interrupt; external name 'TIM15_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure I2C2_interrupt; external name 'I2C2_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure SPI2_interrupt; external name 'SPI2_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+procedure USART2_interrupt; external name 'USART2_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long 0
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long 0
+  .long DMA1_Channel1_interrupt
+  .long DMA1_Channel2_3_interrupt
+  .long DMA1_Channel4_5_interrupt
+  .long ADC1_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long 0
+  .long TIM3_interrupt
+  .long TIM6_interrupt
+  .long 0
+  .long TIM14_interrupt
+  .long TIM15_interrupt
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long I2C2_interrupt
+  .long SPI1_interrupt
+  .long SPI2_interrupt
+  .long USART1_interrupt
+  .long USART2_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak DMA1_Channel1_interrupt
+  .weak DMA1_Channel2_3_interrupt
+  .weak DMA1_Channel4_5_interrupt
+  .weak ADC1_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM3_interrupt
+  .weak TIM6_interrupt
+  .weak TIM14_interrupt
+  .weak TIM15_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak I2C2_interrupt
+  .weak SPI1_interrupt
+  .weak SPI2_interrupt
+  .weak USART1_interrupt
+  .weak USART2_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set DMA1_Channel1_interrupt, HaltProc
+  .set DMA1_Channel2_3_interrupt, HaltProc
+  .set DMA1_Channel4_5_interrupt, HaltProc
+  .set ADC1_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM6_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM15_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set I2C2_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set SPI2_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .set USART2_interrupt, HaltProc
+  .text
+end;
+end.
diff -Naur fpc-save/rtl/embedded/arm/stm32f030xc.pp fpc-build/rtl/embedded/arm/stm32f030xc.pp
--- fpc-save/rtl/embedded/arm/stm32f030xc.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f030xc.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,564 @@
+unit stm32f030xc;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f030xc.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_IRQn   = 4,                   // RCC global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    DMA1_Channel1_IRQn = 9,           // DMA1 Channel 1 Interrupt
+    DMA1_Channel2_3_IRQn = 10,        // DMA1 Channel 2 and Channel 3 Interrupt
+    DMA1_Channel4_5_IRQn = 11,        // DMA1 Channel 4 and Channel 5 Interrupt
+    ADC1_IRQn  = 12,                  // ADC1 Interrupt
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM6_IRQn  = 17,                  // TIM6 global Interrupt
+    TIM7_IRQn  = 18,                  // TIM7 global Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM15_IRQn = 20,                  // TIM15 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt & EXTI Line23 Interrupt (I2C1 wakeup)
+    I2C2_IRQn  = 24,                  // I2C2 Event Interrupt
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    SPI2_IRQn  = 26,                  // SPI2 global Interrupt
+    USART1_IRQn = 27,                 // USART1 global Interrupt & EXTI Line25 Interrupt (USART1 wakeup)
+    USART2_IRQn = 28,                 // USART2 global Interrupt & EXTI Line26 Interrupt (USART2 wakeup)
+    USART3_6_IRQn = 29                // USART3 to USART6 global Interrupt
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    RESERVED3  : longword;            // Reserved,                                                    0x14
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+    RESERVED0  : array[0..39] of longword; // Reserved as declared by channel typedef                   0x08 - 0xA4
+    CSELR      : longword;            // Channel selection register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+    WRP1       : word;                // FLASH option byte write protection 1
+    WRP2       : word;                // FLASH option byte write protection 2
+    WRP3       : word;                // FLASH option byte write protection 3
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    WUTR       : longword;            // RTC wakeup timer register
+    RESERVED1  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED2  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM6_BASE    = APBPERIPH_BASE + $00001000;
+  TIM7_BASE    = APBPERIPH_BASE + $00001400;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  SPI2_BASE    = APBPERIPH_BASE + $00003800;
+  USART2_BASE  = APBPERIPH_BASE + $00004400;
+  USART3_BASE  = APBPERIPH_BASE + $00004800;
+  USART4_BASE  = APBPERIPH_BASE + $00004C00;
+  USART5_BASE  = APBPERIPH_BASE + $00005000;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  I2C2_BASE    = APBPERIPH_BASE + $00005800;
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  USART6_BASE  = APBPERIPH_BASE + $00011400;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM15_BASE   = APBPERIPH_BASE + $00014000;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOD_BASE   = AHB2PERIPH_BASE + $00000C00;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM6         : TTIM_Registers absolute TIM6_BASE;
+  TIM7         : TTIM_Registers absolute TIM7_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  USART2       : TUSART_Registers absolute USART2_BASE;
+  USART3       : TUSART_Registers absolute USART3_BASE;
+  USART4       : TUSART_Registers absolute USART4_BASE;
+  USART5       : TUSART_Registers absolute USART5_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  I2C2         : TI2C_Registers absolute I2C2_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  USART6       : TUSART_Registers absolute USART6_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  SPI2         : TSPI_Registers absolute SPI2_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM15        : TTIM_Registers absolute TIM15_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOD        : TGPIO_Registers absolute GPIOD_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_interrupt; external name 'RCC_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure DMA1_Channel1_interrupt; external name 'DMA1_Channel1_interrupt';
+procedure DMA1_Channel2_3_interrupt; external name 'DMA1_Channel2_3_interrupt';
+procedure DMA1_Channel4_5_interrupt; external name 'DMA1_Channel4_5_interrupt';
+procedure ADC1_interrupt; external name 'ADC1_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM6_interrupt; external name 'TIM6_interrupt';
+procedure TIM7_interrupt; external name 'TIM7_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM15_interrupt; external name 'TIM15_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure I2C2_interrupt; external name 'I2C2_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure SPI2_interrupt; external name 'SPI2_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+procedure USART2_interrupt; external name 'USART2_interrupt';
+procedure USART3_6_interrupt; external name 'USART3_6_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long 0
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long 0
+  .long DMA1_Channel1_interrupt
+  .long DMA1_Channel2_3_interrupt
+  .long DMA1_Channel4_5_interrupt
+  .long ADC1_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long 0
+  .long TIM3_interrupt
+  .long TIM6_interrupt
+  .long TIM7_interrupt
+  .long TIM14_interrupt
+  .long TIM15_interrupt
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long I2C2_interrupt
+  .long SPI1_interrupt
+  .long SPI2_interrupt
+  .long USART1_interrupt
+  .long USART2_interrupt
+  .long USART3_6_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak DMA1_Channel1_interrupt
+  .weak DMA1_Channel2_3_interrupt
+  .weak DMA1_Channel4_5_interrupt
+  .weak ADC1_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM3_interrupt
+  .weak TIM6_interrupt
+  .weak TIM7_interrupt
+  .weak TIM14_interrupt
+  .weak TIM15_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak I2C2_interrupt
+  .weak SPI1_interrupt
+  .weak SPI2_interrupt
+  .weak USART1_interrupt
+  .weak USART2_interrupt
+  .weak USART3_6_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set DMA1_Channel1_interrupt, HaltProc
+  .set DMA1_Channel2_3_interrupt, HaltProc
+  .set DMA1_Channel4_5_interrupt, HaltProc
+  .set ADC1_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM6_interrupt, HaltProc
+  .set TIM7_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM15_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set I2C2_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set SPI2_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .set USART2_interrupt, HaltProc
+  .set USART3_6_interrupt, HaltProc
+  .text
+end;
+end.
diff -Naur fpc-save/rtl/embedded/arm/stm32f031x6.pp fpc-build/rtl/embedded/arm/stm32f031x6.pp
--- fpc-save/rtl/embedded/arm/stm32f031x6.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f031x6.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,525 @@
+unit stm32f031x6;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f031x6.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    PVD_IRQn   = 1,                   // PVD Interrupt through EXTI Lines 16
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_IRQn   = 4,                   // RCC global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    DMA1_Channel1_IRQn = 9,           // DMA1 Channel 1 Interrupt
+    DMA1_Channel2_3_IRQn = 10,        // DMA1 Channel 2 and Channel 3 Interrupt
+    DMA1_Channel4_5_IRQn = 11,        // DMA1 Channel 4 and Channel 5 Interrupt
+    ADC1_IRQn  = 12,                  // ADC1 Interrupt
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM2_IRQn  = 15,                  // TIM2 global Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt & EXTI Line23 Interrupt (I2C1 wakeup)
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    USART1_IRQn = 27                  // USART1 global Interrupt & EXTI Line25 Interrupt (USART1 wakeup)
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    RESERVED3  : longword;            // Reserved,                                                    0x14
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    RESERVED1  : longword;            // Reserved
+    RESERVED2  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED3  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+    RESERVED4  : longword;            // Reserved
+    RESERVED5  : longword;            // Reserved
+    BKP0R      : longword;            // RTC backup register 0
+    BKP1R      : longword;            // RTC backup register 1
+    BKP2R      : longword;            // RTC backup register 2
+    BKP3R      : longword;            // RTC backup register 3
+    BKP4R      : longword;            // RTC backup register 4
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+    I2SPR      : longword;            // SPI_I2S prescaler register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM2_BASE    = APBPERIPH_BASE + $00000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM2         : TTIM_Registers absolute TIM2_BASE;
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure PVD_interrupt; external name 'PVD_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_interrupt; external name 'RCC_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure DMA1_Channel1_interrupt; external name 'DMA1_Channel1_interrupt';
+procedure DMA1_Channel2_3_interrupt; external name 'DMA1_Channel2_3_interrupt';
+procedure DMA1_Channel4_5_interrupt; external name 'DMA1_Channel4_5_interrupt';
+procedure ADC1_interrupt; external name 'ADC1_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM2_interrupt; external name 'TIM2_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long PVD_interrupt
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long 0
+  .long DMA1_Channel1_interrupt
+  .long DMA1_Channel2_3_interrupt
+  .long DMA1_Channel4_5_interrupt
+  .long ADC1_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long TIM2_interrupt
+  .long TIM3_interrupt
+  .long 0
+  .long 0
+  .long TIM14_interrupt
+  .long 0
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long 0
+  .long SPI1_interrupt
+  .long 0
+  .long USART1_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak PVD_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak DMA1_Channel1_interrupt
+  .weak DMA1_Channel2_3_interrupt
+  .weak DMA1_Channel4_5_interrupt
+  .weak ADC1_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM2_interrupt
+  .weak TIM3_interrupt
+  .weak TIM14_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak SPI1_interrupt
+  .weak USART1_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set PVD_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set DMA1_Channel1_interrupt, HaltProc
+  .set DMA1_Channel2_3_interrupt, HaltProc
+  .set DMA1_Channel4_5_interrupt, HaltProc
+  .set ADC1_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM2_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .text
+end;
+end.
diff -Naur fpc-save/rtl/embedded/arm/stm32f038xx.pp fpc-build/rtl/embedded/arm/stm32f038xx.pp
--- fpc-save/rtl/embedded/arm/stm32f038xx.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f038xx.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,521 @@
+unit stm32f038xx;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f038xx.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_IRQn   = 4,                   // RCC global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    DMA1_Channel1_IRQn = 9,           // DMA1 Channel 1 Interrupt
+    DMA1_Channel2_3_IRQn = 10,        // DMA1 Channel 2 and Channel 3 Interrupt
+    DMA1_Channel4_5_IRQn = 11,        // DMA1 Channel 4 and Channel 5 Interrupt
+    ADC1_IRQn  = 12,                  // ADC1 Interrupt
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM2_IRQn  = 15,                  // TIM2 global Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt & EXTI Line23 Interrupt (I2C1 wakeup)
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    USART1_IRQn = 27                  // USART1 global Interrupt & EXTI Line25 Interrupt (USART1 wakeup)
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    RESERVED3  : longword;            // Reserved,                                                    0x14
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    RESERVED1  : longword;            // Reserved
+    RESERVED2  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED3  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+    RESERVED4  : longword;            // Reserved
+    RESERVED5  : longword;            // Reserved
+    BKP0R      : longword;            // RTC backup register 0
+    BKP1R      : longword;            // RTC backup register 1
+    BKP2R      : longword;            // RTC backup register 2
+    BKP3R      : longword;            // RTC backup register 3
+    BKP4R      : longword;            // RTC backup register 4
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+    I2SPR      : longword;            // SPI_I2S prescaler register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM2_BASE    = APBPERIPH_BASE + $00000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM2         : TTIM_Registers absolute TIM2_BASE;
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_interrupt; external name 'RCC_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure DMA1_Channel1_interrupt; external name 'DMA1_Channel1_interrupt';
+procedure DMA1_Channel2_3_interrupt; external name 'DMA1_Channel2_3_interrupt';
+procedure DMA1_Channel4_5_interrupt; external name 'DMA1_Channel4_5_interrupt';
+procedure ADC1_interrupt; external name 'ADC1_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM2_interrupt; external name 'TIM2_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long 0
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long 0
+  .long DMA1_Channel1_interrupt
+  .long DMA1_Channel2_3_interrupt
+  .long DMA1_Channel4_5_interrupt
+  .long ADC1_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long TIM2_interrupt
+  .long TIM3_interrupt
+  .long 0
+  .long 0
+  .long TIM14_interrupt
+  .long 0
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long 0
+  .long SPI1_interrupt
+  .long 0
+  .long USART1_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak DMA1_Channel1_interrupt
+  .weak DMA1_Channel2_3_interrupt
+  .weak DMA1_Channel4_5_interrupt
+  .weak ADC1_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM2_interrupt
+  .weak TIM3_interrupt
+  .weak TIM14_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak SPI1_interrupt
+  .weak USART1_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set DMA1_Channel1_interrupt, HaltProc
+  .set DMA1_Channel2_3_interrupt, HaltProc
+  .set DMA1_Channel4_5_interrupt, HaltProc
+  .set ADC1_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM2_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .text
+end;
+end.
diff -Naur fpc-save/rtl/embedded/arm/stm32f042x6.pp fpc-build/rtl/embedded/arm/stm32f042x6.pp
--- fpc-save/rtl/embedded/arm/stm32f042x6.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f042x6.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,677 @@
+unit stm32f042x6;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f042x6.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    PVD_VDDIO2_IRQn = 1,              // PVD & VDDIO2 Interrupt through EXTI Lines 16 and 31
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_CRS_IRQn = 4,                 // RCC & CRS global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    TSC_IRQn   = 8,                   // Touch Sensing Controller Interrupts
+    DMA1_Channel1_IRQn = 9,           // DMA1 Channel 1 Interrupt
+    DMA1_Channel2_3_IRQn = 10,        // DMA1 Channel 2 and Channel 3 Interrupt
+    DMA1_Channel4_5_IRQn = 11,        // DMA1 Channel 4 and Channel 5 Interrupt
+    ADC1_IRQn  = 12,                  // ADC1 Interrupt
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM2_IRQn  = 15,                  // TIM2 global Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt & EXTI Line23 Interrupt (I2C1 wakeup)
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    SPI2_IRQn  = 26,                  // SPI2 global Interrupt
+    USART1_IRQn = 27,                 // USART1 global Interrupt & EXTI Line25 Interrupt (USART1 wakeup)
+    USART2_IRQn = 28,                 // USART2 global Interrupt
+    CEC_CAN_IRQn = 30,                // CEC and CAN global Interrupts & EXTI Line27 Interrupt
+    USB_IRQn   = 31                   // USB global Interrupt  & EXTI Line18 Interrupt
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCAN_TXMAILBOX_Registers = record
+    TIR        : longword;            // CAN TX mailbox identifier register
+    TDTR       : longword;            // CAN mailbox data length control and time stamp register
+    TDLR       : longword;            // CAN mailbox data low register
+    TDHR       : longword;            // CAN mailbox data high register
+  end;
+
+  TCAN_FIFOMAILBOX_Registers = record
+    RIR        : longword;            // CAN receive FIFO mailbox identifier register
+    RDTR       : longword;            // CAN receive FIFO mailbox data length control and time stamp register
+    RDLR       : longword;            // CAN receive FIFO mailbox data low register
+    RDHR       : longword;            // CAN receive FIFO mailbox data high register
+  end;
+
+  TCAN_FILTERREGISTER_Registers = record
+    FR1        : longword;            // CAN Filter bank register 1
+    FR2        : longword;            // CAN Filter bank register 1
+  end;
+
+  TCAN_Registers = record
+    MCR        : longword;            // CAN master control register
+    MSR        : longword;            // CAN master status register
+    TSR        : longword;            // CAN transmit status register
+    RF0R       : longword;            // CAN receive FIFO 0 register
+    RF1R       : longword;            // CAN receive FIFO 1 register
+    IER        : longword;            // CAN interrupt enable register
+    ESR        : longword;            // CAN error status register
+    BTR        : longword;            // CAN bit timing register
+    RESERVED0  : array[0..87] of longword; // Reserved, 0x020 - 0x17F
+    sTxMailBox : array[0..2] of TCAN_TxMailBox_Registers; // CAN Tx MailBox
+    sFIFOMailBox : array[0..1] of TCAN_FIFOMailBox_Registers; // CAN FIFO MailBox
+    RESERVED1  : array[0..11] of longword; // Reserved, 0x1D0 - 0x1FF
+    FMR        : longword;            // CAN filter master register
+    FM1R       : longword;            // CAN filter mode register
+    RESERVED2  : longword;            // Reserved, 0x208
+    FS1R       : longword;            // CAN filter scale register
+    RESERVED3  : longword;            // Reserved, 0x210
+    FFA1R      : longword;            // CAN filter FIFO assignment register
+    RESERVED4  : longword;            // Reserved, 0x218
+    FA1R       : longword;            // CAN filter activation register
+    RESERVED5  : array[0..7] of longword; // Reserved, 0x220-0x23F
+    sFilterRegister : array[0..27] of TCAN_FilterRegister_Registers; // CAN Filter Register
+  end;
+
+  TCEC_Registers = record
+    CR         : longword;            // CEC control register
+    CFGR       : longword;            // CEC configuration register
+    TXDR       : longword;            // CEC Tx data register
+    RXDR       : longword;            // CEC Rx Data Register
+    ISR        : longword;            // CEC Interrupt and Status Register
+    IER        : longword;            // CEC interrupt enable register
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    RESERVED3  : longword;            // Reserved,                                                    0x14
+  end;
+
+  TCRS_Registers = record
+    CR         : longword;            // CRS ccontrol register
+    CFGR       : longword;            // CRS configuration register
+    ISR        : longword;            // CRS interrupt and status register
+    ICR        : longword;            // CRS interrupt flag clear register
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    RESERVED1  : longword;            // Reserved
+    RESERVED2  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED3  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+    RESERVED4  : longword;            // Reserved
+    RESERVED5  : longword;            // Reserved
+    BKP0R      : longword;            // RTC backup register 0
+    BKP1R      : longword;            // RTC backup register 1
+    BKP2R      : longword;            // RTC backup register 2
+    BKP3R      : longword;            // RTC backup register 3
+    BKP4R      : longword;            // RTC backup register 4
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+    I2SPR      : longword;            // SPI_I2S prescaler register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TTSC_Registers = record
+    CR         : longword;            // TSC control register
+    IER        : longword;            // TSC interrupt enable register
+    ICR        : longword;            // TSC interrupt clear register
+    ISR        : longword;            // TSC interrupt status register
+    IOHCR      : longword;            // TSC I/O hysteresis control register
+    RESERVED1  : longword;            // Reserved
+    IOASCR     : longword;            // TSC I/O analog switch control register
+    RESERVED2  : longword;            // Reserved
+    IOSCR      : longword;            // TSC I/O sampling control register
+    RESERVED3  : longword;            // Reserved
+    IOCCR      : longword;            // TSC I/O channel control register
+    RESERVED4  : longword;            // Reserved
+    IOGCSR     : longword;            // TSC I/O group control status register
+    IOGXCR     : array[0..7] of longword; // TSC I/O group x counter register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TUSB_Registers = record
+    EP0R       : word;                // USB Endpoint 0 register
+    RESERVED0  : word;                // Reserved
+    EP1R       : word;                // USB Endpoint 1 register
+    RESERVED1  : word;                // Reserved
+    EP2R       : word;                // USB Endpoint 2 register
+    RESERVED2  : word;                // Reserved
+    EP3R       : word;                // USB Endpoint 3 register
+    RESERVED3  : word;                // Reserved
+    EP4R       : word;                // USB Endpoint 4 register
+    RESERVED4  : word;                // Reserved
+    EP5R       : word;                // USB Endpoint 5 register
+    RESERVED5  : word;                // Reserved
+    EP6R       : word;                // USB Endpoint 6 register
+    RESERVED6  : word;                // Reserved
+    EP7R       : word;                // USB Endpoint 7 register
+    RESERVED7  : array[0..16] of word; // Reserved
+    CNTR       : word;                // Control register
+    RESERVED8  : word;                // Reserved
+    ISTR       : word;                // Interrupt status register
+    RESERVED9  : word;                // Reserved
+    FNR        : word;                // Frame number register
+    RESERVEDA  : word;                // Reserved
+    DADDR      : word;                // Device address register
+    RESERVEDB  : word;                // Reserved
+    BTABLE     : word;                // Buffer Table address register
+    RESERVEDC  : word;                // Reserved
+    LPMCSR     : word;                // LPM Control and Status register
+    RESERVEDD  : word;                // Reserved
+    BCDR       : word;                // Battery Charging detector register
+    RESERVEDE  : word;                // Reserved
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM2_BASE    = APBPERIPH_BASE + $00000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  SPI2_BASE    = APBPERIPH_BASE + $00003800;
+  USART2_BASE  = APBPERIPH_BASE + $00004400;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  USB_BASE     = APBPERIPH_BASE + $00005C00; // USB_IP Peripheral Registers base address
+  CAN_BASE     = APBPERIPH_BASE + $00006400;
+  CRS_BASE     = APBPERIPH_BASE + $00006C00;
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  CEC_BASE     = APBPERIPH_BASE + $00007800;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  DMA1_Channel6_BASE = DMA1_BASE + $0000006C;
+  DMA1_Channel7_BASE = DMA1_BASE + $00000080;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  TSC_BASE     = AHBPERIPH_BASE + $00004000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM2         : TTIM_Registers absolute TIM2_BASE;
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  USART2       : TUSART_Registers absolute USART2_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  CAN          : TCAN_Registers absolute CAN_BASE;
+  CRS          : TCRS_Registers absolute CRS_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  CEC          : TCEC_Registers absolute CEC_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  SPI2         : TSPI_Registers absolute SPI2_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  DMA1_Channel6 : TDMA_Channel_Registers absolute DMA1_Channel6_BASE;
+  DMA1_Channel7 : TDMA_Channel_Registers absolute DMA1_Channel7_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  TSC          : TTSC_Registers absolute TSC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+  USB          : TUSB_Registers absolute USB_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure PVD_VDDIO2_interrupt; external name 'PVD_VDDIO2_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_CRS_interrupt; external name 'RCC_CRS_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure TSC_interrupt; external name 'TSC_interrupt';
+procedure DMA1_Channel1_interrupt; external name 'DMA1_Channel1_interrupt';
+procedure DMA1_Channel2_3_interrupt; external name 'DMA1_Channel2_3_interrupt';
+procedure DMA1_Channel4_5_interrupt; external name 'DMA1_Channel4_5_interrupt';
+procedure ADC1_interrupt; external name 'ADC1_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM2_interrupt; external name 'TIM2_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure SPI2_interrupt; external name 'SPI2_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+procedure USART2_interrupt; external name 'USART2_interrupt';
+procedure CEC_CAN_interrupt; external name 'CEC_CAN_interrupt';
+procedure USB_interrupt; external name 'USB_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long PVD_VDDIO2_interrupt
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_CRS_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long TSC_interrupt
+  .long DMA1_Channel1_interrupt
+  .long DMA1_Channel2_3_interrupt
+  .long DMA1_Channel4_5_interrupt
+  .long ADC1_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long TIM2_interrupt
+  .long TIM3_interrupt
+  .long 0
+  .long 0
+  .long TIM14_interrupt
+  .long 0
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long 0
+  .long SPI1_interrupt
+  .long SPI2_interrupt
+  .long USART1_interrupt
+  .long USART2_interrupt
+  .long 0
+  .long CEC_CAN_interrupt
+  .long USB_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak PVD_VDDIO2_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_CRS_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak TSC_interrupt
+  .weak DMA1_Channel1_interrupt
+  .weak DMA1_Channel2_3_interrupt
+  .weak DMA1_Channel4_5_interrupt
+  .weak ADC1_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM2_interrupt
+  .weak TIM3_interrupt
+  .weak TIM14_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak SPI1_interrupt
+  .weak SPI2_interrupt
+  .weak USART1_interrupt
+  .weak USART2_interrupt
+  .weak CEC_CAN_interrupt
+  .weak USB_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set PVD_VDDIO2_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_CRS_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set TSC_interrupt, HaltProc
+  .set DMA1_Channel1_interrupt, HaltProc
+  .set DMA1_Channel2_3_interrupt, HaltProc
+  .set DMA1_Channel4_5_interrupt, HaltProc
+  .set ADC1_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM2_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set SPI2_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .set USART2_interrupt, HaltProc
+  .set CEC_CAN_interrupt, HaltProc
+  .set USB_interrupt, HaltProc
+  .text
+end;
+end.
diff -Naur fpc-save/rtl/embedded/arm/stm32f048xx.pp fpc-build/rtl/embedded/arm/stm32f048xx.pp
--- fpc-save/rtl/embedded/arm/stm32f048xx.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f048xx.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,677 @@
+unit stm32f048xx;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f048xx.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    VDDIO2_IRQn = 1,                  // VDDIO2 Interrupt through EXTI Line 31
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_CRS_IRQn = 4,                 // RCC & CRS global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    TSC_IRQn   = 8,                   // Touch Sensing Controller Interrupts
+    DMA1_Channel1_IRQn = 9,           // DMA1 Channel 1 Interrupt
+    DMA1_Channel2_3_IRQn = 10,        // DMA1 Channel 2 and Channel 3 Interrupt
+    DMA1_Channel4_5_IRQn = 11,        // DMA1 Channel 4 and Channel 5 Interrupt
+    ADC1_IRQn  = 12,                  // ADC1 Interrupt
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM2_IRQn  = 15,                  // TIM2 global Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt & EXTI Line23 Interrupt (I2C1 wakeup)
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    SPI2_IRQn  = 26,                  // SPI2 global Interrupt
+    USART1_IRQn = 27,                 // USART1 global Interrupt & EXTI Line25 Interrupt (USART1 wakeup)
+    USART2_IRQn = 28,                 // USART2 global Interrupt
+    CEC_CAN_IRQn = 30,                // CEC and CAN global Interrupts & EXTI Line27 Interrupt
+    USB_IRQn   = 31                   // USB global Interrupt  & EXTI Line18 Interrupt
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCAN_TXMAILBOX_Registers = record
+    TIR        : longword;            // CAN TX mailbox identifier register
+    TDTR       : longword;            // CAN mailbox data length control and time stamp register
+    TDLR       : longword;            // CAN mailbox data low register
+    TDHR       : longword;            // CAN mailbox data high register
+  end;
+
+  TCAN_FIFOMAILBOX_Registers = record
+    RIR        : longword;            // CAN receive FIFO mailbox identifier register
+    RDTR       : longword;            // CAN receive FIFO mailbox data length control and time stamp register
+    RDLR       : longword;            // CAN receive FIFO mailbox data low register
+    RDHR       : longword;            // CAN receive FIFO mailbox data high register
+  end;
+
+  TCAN_FILTERREGISTER_Registers = record
+    FR1        : longword;            // CAN Filter bank register 1
+    FR2        : longword;            // CAN Filter bank register 1
+  end;
+
+  TCAN_Registers = record
+    MCR        : longword;            // CAN master control register
+    MSR        : longword;            // CAN master status register
+    TSR        : longword;            // CAN transmit status register
+    RF0R       : longword;            // CAN receive FIFO 0 register
+    RF1R       : longword;            // CAN receive FIFO 1 register
+    IER        : longword;            // CAN interrupt enable register
+    ESR        : longword;            // CAN error status register
+    BTR        : longword;            // CAN bit timing register
+    RESERVED0  : array[0..87] of longword; // Reserved, 0x020 - 0x17F
+    sTxMailBox : array[0..2] of TCAN_TxMailBox_Registers; // CAN Tx MailBox
+    sFIFOMailBox : array[0..1] of TCAN_FIFOMailBox_Registers; // CAN FIFO MailBox
+    RESERVED1  : array[0..11] of longword; // Reserved, 0x1D0 - 0x1FF
+    FMR        : longword;            // CAN filter master register
+    FM1R       : longword;            // CAN filter mode register
+    RESERVED2  : longword;            // Reserved, 0x208
+    FS1R       : longword;            // CAN filter scale register
+    RESERVED3  : longword;            // Reserved, 0x210
+    FFA1R      : longword;            // CAN filter FIFO assignment register
+    RESERVED4  : longword;            // Reserved, 0x218
+    FA1R       : longword;            // CAN filter activation register
+    RESERVED5  : array[0..7] of longword; // Reserved, 0x220-0x23F
+    sFilterRegister : array[0..27] of TCAN_FilterRegister_Registers; // CAN Filter Register
+  end;
+
+  TCEC_Registers = record
+    CR         : longword;            // CEC control register
+    CFGR       : longword;            // CEC configuration register
+    TXDR       : longword;            // CEC Tx data register
+    RXDR       : longword;            // CEC Rx Data Register
+    ISR        : longword;            // CEC Interrupt and Status Register
+    IER        : longword;            // CEC interrupt enable register
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    RESERVED3  : longword;            // Reserved,                                                    0x14
+  end;
+
+  TCRS_Registers = record
+    CR         : longword;            // CRS ccontrol register
+    CFGR       : longword;            // CRS configuration register
+    ISR        : longword;            // CRS interrupt and status register
+    ICR        : longword;            // CRS interrupt flag clear register
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    RESERVED1  : longword;            // Reserved
+    RESERVED2  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED3  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+    RESERVED4  : longword;            // Reserved
+    RESERVED5  : longword;            // Reserved
+    BKP0R      : longword;            // RTC backup register 0
+    BKP1R      : longword;            // RTC backup register 1
+    BKP2R      : longword;            // RTC backup register 2
+    BKP3R      : longword;            // RTC backup register 3
+    BKP4R      : longword;            // RTC backup register 4
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+    I2SPR      : longword;            // SPI_I2S prescaler register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TTSC_Registers = record
+    CR         : longword;            // TSC control register
+    IER        : longword;            // TSC interrupt enable register
+    ICR        : longword;            // TSC interrupt clear register
+    ISR        : longword;            // TSC interrupt status register
+    IOHCR      : longword;            // TSC I/O hysteresis control register
+    RESERVED1  : longword;            // Reserved
+    IOASCR     : longword;            // TSC I/O analog switch control register
+    RESERVED2  : longword;            // Reserved
+    IOSCR      : longword;            // TSC I/O sampling control register
+    RESERVED3  : longword;            // Reserved
+    IOCCR      : longword;            // TSC I/O channel control register
+    RESERVED4  : longword;            // Reserved
+    IOGCSR     : longword;            // TSC I/O group control status register
+    IOGXCR     : array[0..7] of longword; // TSC I/O group x counter register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TUSB_Registers = record
+    EP0R       : word;                // USB Endpoint 0 register
+    RESERVED0  : word;                // Reserved
+    EP1R       : word;                // USB Endpoint 1 register
+    RESERVED1  : word;                // Reserved
+    EP2R       : word;                // USB Endpoint 2 register
+    RESERVED2  : word;                // Reserved
+    EP3R       : word;                // USB Endpoint 3 register
+    RESERVED3  : word;                // Reserved
+    EP4R       : word;                // USB Endpoint 4 register
+    RESERVED4  : word;                // Reserved
+    EP5R       : word;                // USB Endpoint 5 register
+    RESERVED5  : word;                // Reserved
+    EP6R       : word;                // USB Endpoint 6 register
+    RESERVED6  : word;                // Reserved
+    EP7R       : word;                // USB Endpoint 7 register
+    RESERVED7  : array[0..16] of word; // Reserved
+    CNTR       : word;                // Control register
+    RESERVED8  : word;                // Reserved
+    ISTR       : word;                // Interrupt status register
+    RESERVED9  : word;                // Reserved
+    FNR        : word;                // Frame number register
+    RESERVEDA  : word;                // Reserved
+    DADDR      : word;                // Device address register
+    RESERVEDB  : word;                // Reserved
+    BTABLE     : word;                // Buffer Table address register
+    RESERVEDC  : word;                // Reserved
+    LPMCSR     : word;                // LPM Control and Status register
+    RESERVEDD  : word;                // Reserved
+    BCDR       : word;                // Battery Charging detector register
+    RESERVEDE  : word;                // Reserved
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM2_BASE    = APBPERIPH_BASE + $00000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  SPI2_BASE    = APBPERIPH_BASE + $00003800;
+  USART2_BASE  = APBPERIPH_BASE + $00004400;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  USB_BASE     = APBPERIPH_BASE + $00005C00; // USB_IP Peripheral Registers base address
+  CAN_BASE     = APBPERIPH_BASE + $00006400;
+  CRS_BASE     = APBPERIPH_BASE + $00006C00;
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  CEC_BASE     = APBPERIPH_BASE + $00007800;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  DMA1_Channel6_BASE = DMA1_BASE + $0000006C;
+  DMA1_Channel7_BASE = DMA1_BASE + $00000080;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  TSC_BASE     = AHBPERIPH_BASE + $00004000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM2         : TTIM_Registers absolute TIM2_BASE;
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  USART2       : TUSART_Registers absolute USART2_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  CAN          : TCAN_Registers absolute CAN_BASE;
+  CRS          : TCRS_Registers absolute CRS_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  CEC          : TCEC_Registers absolute CEC_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  SPI2         : TSPI_Registers absolute SPI2_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  DMA1_Channel6 : TDMA_Channel_Registers absolute DMA1_Channel6_BASE;
+  DMA1_Channel7 : TDMA_Channel_Registers absolute DMA1_Channel7_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  TSC          : TTSC_Registers absolute TSC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+  USB          : TUSB_Registers absolute USB_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure VDDIO2_interrupt; external name 'VDDIO2_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_CRS_interrupt; external name 'RCC_CRS_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure TSC_interrupt; external name 'TSC_interrupt';
+procedure DMA1_Channel1_interrupt; external name 'DMA1_Channel1_interrupt';
+procedure DMA1_Channel2_3_interrupt; external name 'DMA1_Channel2_3_interrupt';
+procedure DMA1_Channel4_5_interrupt; external name 'DMA1_Channel4_5_interrupt';
+procedure ADC1_interrupt; external name 'ADC1_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM2_interrupt; external name 'TIM2_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure SPI2_interrupt; external name 'SPI2_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+procedure USART2_interrupt; external name 'USART2_interrupt';
+procedure CEC_CAN_interrupt; external name 'CEC_CAN_interrupt';
+procedure USB_interrupt; external name 'USB_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long VDDIO2_interrupt
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_CRS_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long TSC_interrupt
+  .long DMA1_Channel1_interrupt
+  .long DMA1_Channel2_3_interrupt
+  .long DMA1_Channel4_5_interrupt
+  .long ADC1_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long TIM2_interrupt
+  .long TIM3_interrupt
+  .long 0
+  .long 0
+  .long TIM14_interrupt
+  .long 0
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long 0
+  .long SPI1_interrupt
+  .long SPI2_interrupt
+  .long USART1_interrupt
+  .long USART2_interrupt
+  .long 0
+  .long CEC_CAN_interrupt
+  .long USB_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak VDDIO2_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_CRS_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak TSC_interrupt
+  .weak DMA1_Channel1_interrupt
+  .weak DMA1_Channel2_3_interrupt
+  .weak DMA1_Channel4_5_interrupt
+  .weak ADC1_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM2_interrupt
+  .weak TIM3_interrupt
+  .weak TIM14_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak SPI1_interrupt
+  .weak SPI2_interrupt
+  .weak USART1_interrupt
+  .weak USART2_interrupt
+  .weak CEC_CAN_interrupt
+  .weak USB_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set VDDIO2_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_CRS_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set TSC_interrupt, HaltProc
+  .set DMA1_Channel1_interrupt, HaltProc
+  .set DMA1_Channel2_3_interrupt, HaltProc
+  .set DMA1_Channel4_5_interrupt, HaltProc
+  .set ADC1_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM2_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set SPI2_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .set USART2_interrupt, HaltProc
+  .set CEC_CAN_interrupt, HaltProc
+  .set USB_interrupt, HaltProc
+  .text
+end;
+end.
diff -Naur fpc-save/rtl/embedded/arm/stm32f051x8.pp fpc-build/rtl/embedded/arm/stm32f051x8.pp
--- fpc-save/rtl/embedded/arm/stm32f051x8.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f051x8.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,631 @@
+unit stm32f051x8;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f051x8.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    PVD_IRQn   = 1,                   // PVD Interrupt through EXTI Lines 16
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_IRQn   = 4,                   // RCC global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    TSC_IRQn   = 8,                   // Touch Sensing Controller Interrupts
+    DMA1_Channel1_IRQn = 9,           // DMA1 Channel 1 Interrupt
+    DMA1_Channel2_3_IRQn = 10,        // DMA1 Channel 2 and Channel 3 Interrupt
+    DMA1_Channel4_5_IRQn = 11,        // DMA1 Channel 4 and Channel 5 Interrupt
+    ADC1_COMP_IRQn = 12,              // ADC1 and COMP interrupts (ADC interrupt combined with EXTI Lines 21 and 22
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM2_IRQn  = 15,                  // TIM2 global Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM6_DAC_IRQn = 17,               // TIM6 global and DAC channel underrun error Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM15_IRQn = 20,                  // TIM15 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt & EXTI Line23 Interrupt (I2C1 wakeup)
+    I2C2_IRQn  = 24,                  // I2C2 Event Interrupt
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    SPI2_IRQn  = 26,                  // SPI2 global Interrupt
+    USART1_IRQn = 27,                 // USART1 global Interrupt & EXTI Line25 Interrupt (USART1 wakeup)
+    USART2_IRQn = 28,                 // USART2 global Interrupt
+    CEC_CAN_IRQn = 30                 // CEC and CAN global Interrupts & EXTI Line27 Interrupt
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCEC_Registers = record
+    CR         : longword;            // CEC control register
+    CFGR       : longword;            // CEC configuration register
+    TXDR       : longword;            // CEC Tx data register
+    RXDR       : longword;            // CEC Rx Data Register
+    ISR        : longword;            // CEC Interrupt and Status Register
+    IER        : longword;            // CEC interrupt enable register
+  end;
+
+  TCOMP_Registers = record
+    CSR        : word;                // COMP control and status register
+  end;
+
+  TCOMP_COMMON_Registers = record
+    CSR        : longword;            // COMP control and status register, used for bits common to several COMP instances
+  end;
+
+  TCOMP1_2_Registers = record
+    CSR        : longword;            // Kept for legacy purpose. Use structure 'COMP_Common_TypeDef'.
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    RESERVED3  : longword;            // Reserved,                                                    0x14
+  end;
+
+  TDAC_Registers = record
+    CR         : longword;            // DAC control register
+    SWTRIGR    : longword;            // DAC software trigger register
+    DHR12R1    : longword;            // DAC channel1 12-bit right-aligned data holding register
+    DHR12L1    : longword;            // DAC channel1 12-bit left aligned data holding register
+    DHR8R1     : longword;            // DAC channel1 8-bit right aligned data holding register
+    RESERVED1  : array[0..5] of longword; // Reserved
+    DOR1       : longword;            // DAC channel1 data output register
+    RESERVED2  : longword;            // Reserved
+    SR         : longword;            // DAC status register
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+    WRP1       : word;                // FLASH option byte write protection 1
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    RESERVED1  : longword;            // Reserved
+    RESERVED2  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED3  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+    RESERVED4  : longword;            // Reserved
+    RESERVED5  : longword;            // Reserved
+    BKP0R      : longword;            // RTC backup register 0
+    BKP1R      : longword;            // RTC backup register 1
+    BKP2R      : longword;            // RTC backup register 2
+    BKP3R      : longword;            // RTC backup register 3
+    BKP4R      : longword;            // RTC backup register 4
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+    I2SPR      : longword;            // SPI_I2S prescaler register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TTSC_Registers = record
+    CR         : longword;            // TSC control register
+    IER        : longword;            // TSC interrupt enable register
+    ICR        : longword;            // TSC interrupt clear register
+    ISR        : longword;            // TSC interrupt status register
+    IOHCR      : longword;            // TSC I/O hysteresis control register
+    RESERVED1  : longword;            // Reserved
+    IOASCR     : longword;            // TSC I/O analog switch control register
+    RESERVED2  : longword;            // Reserved
+    IOSCR      : longword;            // TSC I/O sampling control register
+    RESERVED3  : longword;            // Reserved
+    IOCCR      : longword;            // TSC I/O channel control register
+    RESERVED4  : longword;            // Reserved
+    IOGCSR     : longword;            // TSC I/O group control status register
+    IOGXCR     : array[0..7] of longword; // TSC I/O group x counter register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM2_BASE    = APBPERIPH_BASE + $00000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM6_BASE    = APBPERIPH_BASE + $00001000;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  SPI2_BASE    = APBPERIPH_BASE + $00003800;
+  USART2_BASE  = APBPERIPH_BASE + $00004400;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  I2C2_BASE    = APBPERIPH_BASE + $00005800;
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  DAC_BASE     = APBPERIPH_BASE + $00007400;
+  CEC_BASE     = APBPERIPH_BASE + $00007800;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  COMP_BASE    = APBPERIPH_BASE + $0001001C;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM15_BASE   = APBPERIPH_BASE + $00014000;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  TSC_BASE     = AHBPERIPH_BASE + $00004000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOD_BASE   = AHB2PERIPH_BASE + $00000C00;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM2         : TTIM_Registers absolute TIM2_BASE;
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM6         : TTIM_Registers absolute TIM6_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  USART2       : TUSART_Registers absolute USART2_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  I2C2         : TI2C_Registers absolute I2C2_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  DAC1         : TDAC_Registers absolute DAC_BASE;
+  DAC          : TDAC_Registers absolute DAC_BASE; // Kept for legacy purpose
+  CEC          : TCEC_Registers absolute CEC_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  COMP1        : TCOMP_Registers absolute COMP_BASE;
+  COMP2        : TCOMP_Registers absolute $00000002;
+  COMP12_COMMON : TCOMP_Common_Registers absolute COMP_BASE;
+  COMP         : TCOMP1_2_Registers absolute COMP_BASE; // Kept for legacy purpose
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  SPI2         : TSPI_Registers absolute SPI2_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM15        : TTIM_Registers absolute TIM15_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  TSC          : TTSC_Registers absolute TSC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOD        : TGPIO_Registers absolute GPIOD_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure PVD_interrupt; external name 'PVD_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_interrupt; external name 'RCC_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure TSC_interrupt; external name 'TSC_interrupt';
+procedure DMA1_Channel1_interrupt; external name 'DMA1_Channel1_interrupt';
+procedure DMA1_Channel2_3_interrupt; external name 'DMA1_Channel2_3_interrupt';
+procedure DMA1_Channel4_5_interrupt; external name 'DMA1_Channel4_5_interrupt';
+procedure ADC1_COMP_interrupt; external name 'ADC1_COMP_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM2_interrupt; external name 'TIM2_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM6_DAC_interrupt; external name 'TIM6_DAC_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM15_interrupt; external name 'TIM15_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure I2C2_interrupt; external name 'I2C2_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure SPI2_interrupt; external name 'SPI2_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+procedure USART2_interrupt; external name 'USART2_interrupt';
+procedure CEC_CAN_interrupt; external name 'CEC_CAN_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long PVD_interrupt
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long TSC_interrupt
+  .long DMA1_Channel1_interrupt
+  .long DMA1_Channel2_3_interrupt
+  .long DMA1_Channel4_5_interrupt
+  .long ADC1_COMP_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long TIM2_interrupt
+  .long TIM3_interrupt
+  .long TIM6_DAC_interrupt
+  .long 0
+  .long TIM14_interrupt
+  .long TIM15_interrupt
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long I2C2_interrupt
+  .long SPI1_interrupt
+  .long SPI2_interrupt
+  .long USART1_interrupt
+  .long USART2_interrupt
+  .long 0
+  .long CEC_CAN_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak PVD_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak TSC_interrupt
+  .weak DMA1_Channel1_interrupt
+  .weak DMA1_Channel2_3_interrupt
+  .weak DMA1_Channel4_5_interrupt
+  .weak ADC1_COMP_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM2_interrupt
+  .weak TIM3_interrupt
+  .weak TIM6_DAC_interrupt
+  .weak TIM14_interrupt
+  .weak TIM15_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak I2C2_interrupt
+  .weak SPI1_interrupt
+  .weak SPI2_interrupt
+  .weak USART1_interrupt
+  .weak USART2_interrupt
+  .weak CEC_CAN_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set PVD_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set TSC_interrupt, HaltProc
+  .set DMA1_Channel1_interrupt, HaltProc
+  .set DMA1_Channel2_3_interrupt, HaltProc
+  .set DMA1_Channel4_5_interrupt, HaltProc
+  .set ADC1_COMP_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM2_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM6_DAC_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM15_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set I2C2_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set SPI2_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .set USART2_interrupt, HaltProc
+  .set CEC_CAN_interrupt, HaltProc
+  .text
+end;
+end.
diff -Naur fpc-save/rtl/embedded/arm/stm32f058xx.pp fpc-build/rtl/embedded/arm/stm32f058xx.pp
--- fpc-save/rtl/embedded/arm/stm32f058xx.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f058xx.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,627 @@
+unit stm32f058xx;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f058xx.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_IRQn   = 4,                   // RCC global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    TSC_IRQn   = 8,                   // Touch Sensing Controller Interrupts
+    DMA1_Channel1_IRQn = 9,           // DMA1 Channel 1 Interrupt
+    DMA1_Channel2_3_IRQn = 10,        // DMA1 Channel 2 and Channel 3 Interrupt
+    DMA1_Channel4_5_IRQn = 11,        // DMA1 Channel 4 and Channel 5 Interrupt
+    ADC1_COMP_IRQn = 12,              // ADC1 and COMP interrupts (ADC interrupt combined with EXTI Lines 21 and 22
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM2_IRQn  = 15,                  // TIM2 global Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM6_DAC_IRQn = 17,               // TIM6 global and DAC channel underrun error Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM15_IRQn = 20,                  // TIM15 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt & EXTI Line23 Interrupt (I2C1 wakeup)
+    I2C2_IRQn  = 24,                  // I2C2 Event Interrupt
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    SPI2_IRQn  = 26,                  // SPI2 global Interrupt
+    USART1_IRQn = 27,                 // USART1 global Interrupt & EXTI Line25 Interrupt (USART1 wakeup)
+    USART2_IRQn = 28,                 // USART2 global Interrupt
+    CEC_CAN_IRQn = 30                 // CEC and CAN global Interrupts & EXTI Line27 Interrupt
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCEC_Registers = record
+    CR         : longword;            // CEC control register
+    CFGR       : longword;            // CEC configuration register
+    TXDR       : longword;            // CEC Tx data register
+    RXDR       : longword;            // CEC Rx Data Register
+    ISR        : longword;            // CEC Interrupt and Status Register
+    IER        : longword;            // CEC interrupt enable register
+  end;
+
+  TCOMP_Registers = record
+    CSR        : word;                // COMP control and status register
+  end;
+
+  TCOMP_COMMON_Registers = record
+    CSR        : longword;            // COMP control and status register, used for bits common to several COMP instances
+  end;
+
+  TCOMP1_2_Registers = record
+    CSR        : longword;            // Kept for legacy purpose. Use structure 'COMP_Common_TypeDef'.
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    RESERVED3  : longword;            // Reserved,                                                    0x14
+  end;
+
+  TDAC_Registers = record
+    CR         : longword;            // DAC control register
+    SWTRIGR    : longword;            // DAC software trigger register
+    DHR12R1    : longword;            // DAC channel1 12-bit right-aligned data holding register
+    DHR12L1    : longword;            // DAC channel1 12-bit left aligned data holding register
+    DHR8R1     : longword;            // DAC channel1 8-bit right aligned data holding register
+    RESERVED1  : array[0..5] of longword; // Reserved
+    DOR1       : longword;            // DAC channel1 data output register
+    RESERVED2  : longword;            // Reserved
+    SR         : longword;            // DAC status register
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+    WRP1       : word;                // FLASH option byte write protection 1
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    RESERVED1  : longword;            // Reserved
+    RESERVED2  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED3  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+    RESERVED4  : longword;            // Reserved
+    RESERVED5  : longword;            // Reserved
+    BKP0R      : longword;            // RTC backup register 0
+    BKP1R      : longword;            // RTC backup register 1
+    BKP2R      : longword;            // RTC backup register 2
+    BKP3R      : longword;            // RTC backup register 3
+    BKP4R      : longword;            // RTC backup register 4
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+    I2SPR      : longword;            // SPI_I2S prescaler register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TTSC_Registers = record
+    CR         : longword;            // TSC control register
+    IER        : longword;            // TSC interrupt enable register
+    ICR        : longword;            // TSC interrupt clear register
+    ISR        : longword;            // TSC interrupt status register
+    IOHCR      : longword;            // TSC I/O hysteresis control register
+    RESERVED1  : longword;            // Reserved
+    IOASCR     : longword;            // TSC I/O analog switch control register
+    RESERVED2  : longword;            // Reserved
+    IOSCR      : longword;            // TSC I/O sampling control register
+    RESERVED3  : longword;            // Reserved
+    IOCCR      : longword;            // TSC I/O channel control register
+    RESERVED4  : longword;            // Reserved
+    IOGCSR     : longword;            // TSC I/O group control status register
+    IOGXCR     : array[0..7] of longword; // TSC I/O group x counter register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM2_BASE    = APBPERIPH_BASE + $00000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM6_BASE    = APBPERIPH_BASE + $00001000;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  SPI2_BASE    = APBPERIPH_BASE + $00003800;
+  USART2_BASE  = APBPERIPH_BASE + $00004400;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  I2C2_BASE    = APBPERIPH_BASE + $00005800;
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  DAC_BASE     = APBPERIPH_BASE + $00007400;
+  CEC_BASE     = APBPERIPH_BASE + $00007800;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  COMP_BASE    = APBPERIPH_BASE + $0001001C;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM15_BASE   = APBPERIPH_BASE + $00014000;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  TSC_BASE     = AHBPERIPH_BASE + $00004000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOD_BASE   = AHB2PERIPH_BASE + $00000C00;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM2         : TTIM_Registers absolute TIM2_BASE;
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM6         : TTIM_Registers absolute TIM6_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  USART2       : TUSART_Registers absolute USART2_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  I2C2         : TI2C_Registers absolute I2C2_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  DAC1         : TDAC_Registers absolute DAC_BASE;
+  DAC          : TDAC_Registers absolute DAC_BASE; // Kept for legacy purpose
+  CEC          : TCEC_Registers absolute CEC_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  COMP1        : TCOMP_Registers absolute COMP_BASE;
+  COMP2        : TCOMP_Registers absolute $00000002;
+  COMP12_COMMON : TCOMP_Common_Registers absolute COMP_BASE;
+  COMP         : TCOMP1_2_Registers absolute COMP_BASE; // Kept for legacy purpose
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  SPI2         : TSPI_Registers absolute SPI2_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM15        : TTIM_Registers absolute TIM15_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  TSC          : TTSC_Registers absolute TSC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOD        : TGPIO_Registers absolute GPIOD_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_interrupt; external name 'RCC_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure TSC_interrupt; external name 'TSC_interrupt';
+procedure DMA1_Channel1_interrupt; external name 'DMA1_Channel1_interrupt';
+procedure DMA1_Channel2_3_interrupt; external name 'DMA1_Channel2_3_interrupt';
+procedure DMA1_Channel4_5_interrupt; external name 'DMA1_Channel4_5_interrupt';
+procedure ADC1_COMP_interrupt; external name 'ADC1_COMP_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM2_interrupt; external name 'TIM2_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM6_DAC_interrupt; external name 'TIM6_DAC_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM15_interrupt; external name 'TIM15_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure I2C2_interrupt; external name 'I2C2_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure SPI2_interrupt; external name 'SPI2_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+procedure USART2_interrupt; external name 'USART2_interrupt';
+procedure CEC_CAN_interrupt; external name 'CEC_CAN_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long 0
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long TSC_interrupt
+  .long DMA1_Channel1_interrupt
+  .long DMA1_Channel2_3_interrupt
+  .long DMA1_Channel4_5_interrupt
+  .long ADC1_COMP_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long TIM2_interrupt
+  .long TIM3_interrupt
+  .long TIM6_DAC_interrupt
+  .long 0
+  .long TIM14_interrupt
+  .long TIM15_interrupt
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long I2C2_interrupt
+  .long SPI1_interrupt
+  .long SPI2_interrupt
+  .long USART1_interrupt
+  .long USART2_interrupt
+  .long 0
+  .long CEC_CAN_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak TSC_interrupt
+  .weak DMA1_Channel1_interrupt
+  .weak DMA1_Channel2_3_interrupt
+  .weak DMA1_Channel4_5_interrupt
+  .weak ADC1_COMP_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM2_interrupt
+  .weak TIM3_interrupt
+  .weak TIM6_DAC_interrupt
+  .weak TIM14_interrupt
+  .weak TIM15_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak I2C2_interrupt
+  .weak SPI1_interrupt
+  .weak SPI2_interrupt
+  .weak USART1_interrupt
+  .weak USART2_interrupt
+  .weak CEC_CAN_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set TSC_interrupt, HaltProc
+  .set DMA1_Channel1_interrupt, HaltProc
+  .set DMA1_Channel2_3_interrupt, HaltProc
+  .set DMA1_Channel4_5_interrupt, HaltProc
+  .set ADC1_COMP_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM2_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM6_DAC_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM15_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set I2C2_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set SPI2_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .set USART2_interrupt, HaltProc
+  .set CEC_CAN_interrupt, HaltProc
+  .text
+end;
+end.
diff -Naur fpc-save/rtl/embedded/arm/stm32f070x6.pp fpc-build/rtl/embedded/arm/stm32f070x6.pp
--- fpc-save/rtl/embedded/arm/stm32f070x6.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f070x6.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,558 @@
+unit stm32f070x6;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f070x6.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_IRQn   = 4,                   // RCC global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    DMA1_Channel1_IRQn = 9,           // DMA1 Channel 1 Interrupt
+    DMA1_Channel2_3_IRQn = 10,        // DMA1 Channel 2 and Channel 3 Interrupt
+    DMA1_Channel4_5_IRQn = 11,        // DMA1 Channel 4 and Channel 5 Interrupt
+    ADC1_IRQn  = 12,                  // ADC1 Interrupt
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt & EXTI Line23 Interrupt (I2C1 wakeup)
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    USART1_IRQn = 27,                 // USART1 global Interrupt & EXTI Line25 Interrupt (USART1 wakeup)
+    USART2_IRQn = 28,                 // USART2 global Interrupt
+    USB_IRQn   = 31                   // USB global Interrupt  & EXTI Line18 Interrupt
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    RESERVED3  : longword;            // Reserved,                                                    0x14
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    RESERVED1  : longword;            // Reserved
+    RESERVED2  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED3  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TUSB_Registers = record
+    EP0R       : word;                // USB Endpoint 0 register
+    RESERVED0  : word;                // Reserved
+    EP1R       : word;                // USB Endpoint 1 register
+    RESERVED1  : word;                // Reserved
+    EP2R       : word;                // USB Endpoint 2 register
+    RESERVED2  : word;                // Reserved
+    EP3R       : word;                // USB Endpoint 3 register
+    RESERVED3  : word;                // Reserved
+    EP4R       : word;                // USB Endpoint 4 register
+    RESERVED4  : word;                // Reserved
+    EP5R       : word;                // USB Endpoint 5 register
+    RESERVED5  : word;                // Reserved
+    EP6R       : word;                // USB Endpoint 6 register
+    RESERVED6  : word;                // Reserved
+    EP7R       : word;                // USB Endpoint 7 register
+    RESERVED7  : array[0..16] of word; // Reserved
+    CNTR       : word;                // Control register
+    RESERVED8  : word;                // Reserved
+    ISTR       : word;                // Interrupt status register
+    RESERVED9  : word;                // Reserved
+    FNR        : word;                // Frame number register
+    RESERVEDA  : word;                // Reserved
+    DADDR      : word;                // Device address register
+    RESERVEDB  : word;                // Reserved
+    BTABLE     : word;                // Buffer Table address register
+    RESERVEDC  : word;                // Reserved
+    LPMCSR     : word;                // LPM Control and Status register
+    RESERVEDD  : word;                // Reserved
+    BCDR       : word;                // Battery Charging detector register
+    RESERVEDE  : word;                // Reserved
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  USART2_BASE  = APBPERIPH_BASE + $00004400;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  USB_BASE     = APBPERIPH_BASE + $00005C00; // USB_IP Peripheral Registers base address
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOD_BASE   = AHB2PERIPH_BASE + $00000C00;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  USART2       : TUSART_Registers absolute USART2_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOD        : TGPIO_Registers absolute GPIOD_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+  USB          : TUSB_Registers absolute USB_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_interrupt; external name 'RCC_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure DMA1_Channel1_interrupt; external name 'DMA1_Channel1_interrupt';
+procedure DMA1_Channel2_3_interrupt; external name 'DMA1_Channel2_3_interrupt';
+procedure DMA1_Channel4_5_interrupt; external name 'DMA1_Channel4_5_interrupt';
+procedure ADC1_interrupt; external name 'ADC1_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+procedure USART2_interrupt; external name 'USART2_interrupt';
+procedure USB_interrupt; external name 'USB_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long 0
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long 0
+  .long DMA1_Channel1_interrupt
+  .long DMA1_Channel2_3_interrupt
+  .long DMA1_Channel4_5_interrupt
+  .long ADC1_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long 0
+  .long TIM3_interrupt
+  .long 0
+  .long 0
+  .long TIM14_interrupt
+  .long 0
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long 0
+  .long SPI1_interrupt
+  .long 0
+  .long USART1_interrupt
+  .long USART2_interrupt
+  .long 0
+  .long 0
+  .long USB_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak DMA1_Channel1_interrupt
+  .weak DMA1_Channel2_3_interrupt
+  .weak DMA1_Channel4_5_interrupt
+  .weak ADC1_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM3_interrupt
+  .weak TIM14_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak SPI1_interrupt
+  .weak USART1_interrupt
+  .weak USART2_interrupt
+  .weak USB_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set DMA1_Channel1_interrupt, HaltProc
+  .set DMA1_Channel2_3_interrupt, HaltProc
+  .set DMA1_Channel4_5_interrupt, HaltProc
+  .set ADC1_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .set USART2_interrupt, HaltProc
+  .set USB_interrupt, HaltProc
+  .text
+end;
+end.
diff -Naur fpc-save/rtl/embedded/arm/stm32f070xb.pp fpc-build/rtl/embedded/arm/stm32f070xb.pp
--- fpc-save/rtl/embedded/arm/stm32f070xb.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f070xb.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,599 @@
+unit stm32f070xb;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f070xb.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_IRQn   = 4,                   // RCC global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    DMA1_Channel1_IRQn = 9,           // DMA1 Channel 1 Interrupt
+    DMA1_Channel2_3_IRQn = 10,        // DMA1 Channel 2 and Channel 3 Interrupt
+    DMA1_Channel4_5_IRQn = 11,        // DMA1 Channel 4 and Channel 5 Interrupt
+    ADC1_IRQn  = 12,                  // ADC1 Interrupt
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM6_IRQn  = 17,                  // TIM6 global Interrupt
+    TIM7_IRQn  = 18,                  // TIM7 global Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM15_IRQn = 20,                  // TIM15 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt & EXTI Line23 Interrupt (I2C1 wakeup)
+    I2C2_IRQn  = 24,                  // I2C2 Event Interrupt
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    SPI2_IRQn  = 26,                  // SPI2 global Interrupt
+    USART1_IRQn = 27,                 // USART1 global Interrupt
+    USART2_IRQn = 28,                 // USART2 global Interrupt
+    USART3_4_IRQn = 29,               // USART3 and USART4 global Interrupt
+    USB_IRQn   = 31                   // USB global Interrupt  & EXTI Line18 Interrupt
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    RESERVED3  : longword;            // Reserved,                                                    0x14
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+    WRP1       : word;                // FLASH option byte write protection 1
+    WRP2       : word;                // FLASH option byte write protection 2
+    WRP3       : word;                // FLASH option byte write protection 3
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    WUTR       : longword;            // RTC wakeup timer register
+    RESERVED1  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED2  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TUSB_Registers = record
+    EP0R       : word;                // USB Endpoint 0 register
+    RESERVED0  : word;                // Reserved
+    EP1R       : word;                // USB Endpoint 1 register
+    RESERVED1  : word;                // Reserved
+    EP2R       : word;                // USB Endpoint 2 register
+    RESERVED2  : word;                // Reserved
+    EP3R       : word;                // USB Endpoint 3 register
+    RESERVED3  : word;                // Reserved
+    EP4R       : word;                // USB Endpoint 4 register
+    RESERVED4  : word;                // Reserved
+    EP5R       : word;                // USB Endpoint 5 register
+    RESERVED5  : word;                // Reserved
+    EP6R       : word;                // USB Endpoint 6 register
+    RESERVED6  : word;                // Reserved
+    EP7R       : word;                // USB Endpoint 7 register
+    RESERVED7  : array[0..16] of word; // Reserved
+    CNTR       : word;                // Control register
+    RESERVED8  : word;                // Reserved
+    ISTR       : word;                // Interrupt status register
+    RESERVED9  : word;                // Reserved
+    FNR        : word;                // Frame number register
+    RESERVEDA  : word;                // Reserved
+    DADDR      : word;                // Device address register
+    RESERVEDB  : word;                // Reserved
+    BTABLE     : word;                // Buffer Table address register
+    RESERVEDC  : word;                // Reserved
+    LPMCSR     : word;                // LPM Control and Status register
+    RESERVEDD  : word;                // Reserved
+    BCDR       : word;                // Battery Charging detector register
+    RESERVEDE  : word;                // Reserved
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM6_BASE    = APBPERIPH_BASE + $00001000;
+  TIM7_BASE    = APBPERIPH_BASE + $00001400;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  SPI2_BASE    = APBPERIPH_BASE + $00003800;
+  USART2_BASE  = APBPERIPH_BASE + $00004400;
+  USART3_BASE  = APBPERIPH_BASE + $00004800;
+  USART4_BASE  = APBPERIPH_BASE + $00004C00;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  I2C2_BASE    = APBPERIPH_BASE + $00005800;
+  USB_BASE     = APBPERIPH_BASE + $00005C00; // USB_IP Peripheral Registers base address
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM15_BASE   = APBPERIPH_BASE + $00014000;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOD_BASE   = AHB2PERIPH_BASE + $00000C00;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM6         : TTIM_Registers absolute TIM6_BASE;
+  TIM7         : TTIM_Registers absolute TIM7_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  USART2       : TUSART_Registers absolute USART2_BASE;
+  USART3       : TUSART_Registers absolute USART3_BASE;
+  USART4       : TUSART_Registers absolute USART4_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  I2C2         : TI2C_Registers absolute I2C2_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  SPI2         : TSPI_Registers absolute SPI2_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM15        : TTIM_Registers absolute TIM15_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOD        : TGPIO_Registers absolute GPIOD_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+  USB          : TUSB_Registers absolute USB_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_interrupt; external name 'RCC_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure DMA1_Channel1_interrupt; external name 'DMA1_Channel1_interrupt';
+procedure DMA1_Channel2_3_interrupt; external name 'DMA1_Channel2_3_interrupt';
+procedure DMA1_Channel4_5_interrupt; external name 'DMA1_Channel4_5_interrupt';
+procedure ADC1_interrupt; external name 'ADC1_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM6_interrupt; external name 'TIM6_interrupt';
+procedure TIM7_interrupt; external name 'TIM7_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM15_interrupt; external name 'TIM15_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure I2C2_interrupt; external name 'I2C2_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure SPI2_interrupt; external name 'SPI2_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+procedure USART2_interrupt; external name 'USART2_interrupt';
+procedure USART3_4_interrupt; external name 'USART3_4_interrupt';
+procedure USB_interrupt; external name 'USB_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long 0
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long 0
+  .long DMA1_Channel1_interrupt
+  .long DMA1_Channel2_3_interrupt
+  .long DMA1_Channel4_5_interrupt
+  .long ADC1_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long 0
+  .long TIM3_interrupt
+  .long TIM6_interrupt
+  .long TIM7_interrupt
+  .long TIM14_interrupt
+  .long TIM15_interrupt
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long I2C2_interrupt
+  .long SPI1_interrupt
+  .long SPI2_interrupt
+  .long USART1_interrupt
+  .long USART2_interrupt
+  .long USART3_4_interrupt
+  .long 0
+  .long USB_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak DMA1_Channel1_interrupt
+  .weak DMA1_Channel2_3_interrupt
+  .weak DMA1_Channel4_5_interrupt
+  .weak ADC1_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM3_interrupt
+  .weak TIM6_interrupt
+  .weak TIM7_interrupt
+  .weak TIM14_interrupt
+  .weak TIM15_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak I2C2_interrupt
+  .weak SPI1_interrupt
+  .weak SPI2_interrupt
+  .weak USART1_interrupt
+  .weak USART2_interrupt
+  .weak USART3_4_interrupt
+  .weak USB_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set DMA1_Channel1_interrupt, HaltProc
+  .set DMA1_Channel2_3_interrupt, HaltProc
+  .set DMA1_Channel4_5_interrupt, HaltProc
+  .set ADC1_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM6_interrupt, HaltProc
+  .set TIM7_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM15_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set I2C2_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set SPI2_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .set USART2_interrupt, HaltProc
+  .set USART3_4_interrupt, HaltProc
+  .set USB_interrupt, HaltProc
+  .text
+end;
+end.
diff -Naur fpc-save/rtl/embedded/arm/stm32f071xb.pp fpc-build/rtl/embedded/arm/stm32f071xb.pp
--- fpc-save/rtl/embedded/arm/stm32f071xb.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f071xb.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,667 @@
+unit stm32f071xb;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f071xb.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    PVD_VDDIO2_IRQn = 1,              // PVD & VDDIO2 Interrupt through EXTI Lines 16 and 31
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_CRS_IRQn = 4,                 // RCC & CRS global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    TSC_IRQn   = 8,                   // Touch Sensing Controller Interrupts
+    DMA1_Channel1_IRQn = 9,           // DMA1 Channel 1 Interrupt
+    DMA1_Channel2_3_IRQn = 10,        // DMA1 Channel 2 and Channel 3 Interrupt
+    DMA1_Channel4_5_6_7_IRQn = 11,    // DMA1 Channel 4 to Channel 7 Interrupt
+    ADC1_COMP_IRQn = 12,              // ADC1 and COMP interrupts (ADC interrupt combined with EXTI Lines 21 and 22
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM2_IRQn  = 15,                  // TIM2 global Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM6_DAC_IRQn = 17,               // TIM6 global and DAC channel underrun error Interrupt
+    TIM7_IRQn  = 18,                  // TIM7 global Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM15_IRQn = 20,                  // TIM15 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt & EXTI Line23 Interrupt (I2C1 wakeup)
+    I2C2_IRQn  = 24,                  // I2C2 Event Interrupt
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    SPI2_IRQn  = 26,                  // SPI2 global Interrupt
+    USART1_IRQn = 27,                 // USART1 global Interrupt & EXTI Line25 Interrupt (USART1 wakeup)
+    USART2_IRQn = 28,                 // USART2 global Interrupt & EXTI Line26 Interrupt (USART2 wakeup)
+    USART3_4_IRQn = 29,               // USART3 and USART4 global Interrupt
+    CEC_CAN_IRQn = 30                 // CEC and CAN global Interrupts & EXTI Line27 Interrupt
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCEC_Registers = record
+    CR         : longword;            // CEC control register
+    CFGR       : longword;            // CEC configuration register
+    TXDR       : longword;            // CEC Tx data register
+    RXDR       : longword;            // CEC Rx Data Register
+    ISR        : longword;            // CEC Interrupt and Status Register
+    IER        : longword;            // CEC interrupt enable register
+  end;
+
+  TCOMP_Registers = record
+    CSR        : word;                // COMP control and status register
+  end;
+
+  TCOMP_COMMON_Registers = record
+    CSR        : longword;            // COMP control and status register, used for bits common to several COMP instances
+  end;
+
+  TCOMP1_2_Registers = record
+    CSR        : longword;            // Kept for legacy purpose. Use structure 'COMP_Common_TypeDef'.
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    POL        : longword;            // CRC polynomial register
+  end;
+
+  TCRS_Registers = record
+    CR         : longword;            // CRS ccontrol register
+    CFGR       : longword;            // CRS configuration register
+    ISR        : longword;            // CRS interrupt and status register
+    ICR        : longword;            // CRS interrupt flag clear register
+  end;
+
+  TDAC_Registers = record
+    CR         : longword;            // DAC control register
+    SWTRIGR    : longword;            // DAC software trigger register
+    DHR12R1    : longword;            // DAC channel1 12-bit right-aligned data holding register
+    DHR12L1    : longword;            // DAC channel1 12-bit left aligned data holding register
+    DHR8R1     : longword;            // DAC channel1 8-bit right aligned data holding register
+    DHR12R2    : longword;            // DAC channel2 12-bit right aligned data holding register
+    DHR12L2    : longword;            // DAC channel2 12-bit left aligned data holding register
+    DHR8R2     : longword;            // DAC channel2 8-bit right-aligned data holding register
+    DHR12RD    : longword;            // Dual DAC 12-bit right-aligned data holding register
+    DHR12LD    : longword;            // DUAL DAC 12-bit left aligned data holding register
+    DHR8RD     : longword;            // DUAL DAC 8-bit right aligned data holding register
+    DOR1       : longword;            // DAC channel1 data output register
+    DOR2       : longword;            // DAC channel2 data output register
+    SR         : longword;            // DAC status register
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+    WRP1       : word;                // FLASH option byte write protection 1
+    WRP2       : word;                // FLASH option byte write protection 2
+    WRP3       : word;                // FLASH option byte write protection 3
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    WUTR       : longword;            // RTC wakeup timer register
+    RESERVED1  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED2  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+    RESERVED3  : longword;            // Reserved
+    RESERVED4  : longword;            // Reserved
+    BKP0R      : longword;            // RTC backup register 0
+    BKP1R      : longword;            // RTC backup register 1
+    BKP2R      : longword;            // RTC backup register 2
+    BKP3R      : longword;            // RTC backup register 3
+    BKP4R      : longword;            // RTC backup register 4
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+    I2SPR      : longword;            // SPI_I2S prescaler register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TTSC_Registers = record
+    CR         : longword;            // TSC control register
+    IER        : longword;            // TSC interrupt enable register
+    ICR        : longword;            // TSC interrupt clear register
+    ISR        : longword;            // TSC interrupt status register
+    IOHCR      : longword;            // TSC I/O hysteresis control register
+    RESERVED1  : longword;            // Reserved
+    IOASCR     : longword;            // TSC I/O analog switch control register
+    RESERVED2  : longword;            // Reserved
+    IOSCR      : longword;            // TSC I/O sampling control register
+    RESERVED3  : longword;            // Reserved
+    IOCCR      : longword;            // TSC I/O channel control register
+    RESERVED4  : longword;            // Reserved
+    IOGCSR     : longword;            // TSC I/O group control status register
+    IOGXCR     : array[0..7] of longword; // TSC I/O group x counter register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM2_BASE    = APBPERIPH_BASE + $00000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM6_BASE    = APBPERIPH_BASE + $00001000;
+  TIM7_BASE    = APBPERIPH_BASE + $00001400;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  SPI2_BASE    = APBPERIPH_BASE + $00003800;
+  USART2_BASE  = APBPERIPH_BASE + $00004400;
+  USART3_BASE  = APBPERIPH_BASE + $00004800;
+  USART4_BASE  = APBPERIPH_BASE + $00004C00;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  I2C2_BASE    = APBPERIPH_BASE + $00005800;
+  CRS_BASE     = APBPERIPH_BASE + $00006C00;
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  DAC_BASE     = APBPERIPH_BASE + $00007400;
+  CEC_BASE     = APBPERIPH_BASE + $00007800;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  COMP_BASE    = APBPERIPH_BASE + $0001001C;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM15_BASE   = APBPERIPH_BASE + $00014000;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  DMA1_Channel6_BASE = DMA1_BASE + $0000006C;
+  DMA1_Channel7_BASE = DMA1_BASE + $00000080;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  TSC_BASE     = AHBPERIPH_BASE + $00004000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOD_BASE   = AHB2PERIPH_BASE + $00000C00;
+  GPIOE_BASE   = AHB2PERIPH_BASE + $00001000;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM2         : TTIM_Registers absolute TIM2_BASE;
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM6         : TTIM_Registers absolute TIM6_BASE;
+  TIM7         : TTIM_Registers absolute TIM7_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  USART2       : TUSART_Registers absolute USART2_BASE;
+  USART3       : TUSART_Registers absolute USART3_BASE;
+  USART4       : TUSART_Registers absolute USART4_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  I2C2         : TI2C_Registers absolute I2C2_BASE;
+  CRS          : TCRS_Registers absolute CRS_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  DAC1         : TDAC_Registers absolute DAC_BASE;
+  DAC          : TDAC_Registers absolute DAC_BASE; // Kept for legacy purpose
+  CEC          : TCEC_Registers absolute CEC_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  COMP1        : TCOMP_Registers absolute COMP_BASE;
+  COMP2        : TCOMP_Registers absolute $00000002;
+  COMP12_COMMON : TCOMP_Common_Registers absolute COMP_BASE;
+  COMP         : TCOMP1_2_Registers absolute COMP_BASE; // Kept for legacy purpose
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  SPI2         : TSPI_Registers absolute SPI2_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM15        : TTIM_Registers absolute TIM15_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  DMA1_Channel6 : TDMA_Channel_Registers absolute DMA1_Channel6_BASE;
+  DMA1_Channel7 : TDMA_Channel_Registers absolute DMA1_Channel7_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  TSC          : TTSC_Registers absolute TSC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOD        : TGPIO_Registers absolute GPIOD_BASE;
+  GPIOE        : TGPIO_Registers absolute GPIOE_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure PVD_VDDIO2_interrupt; external name 'PVD_VDDIO2_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_CRS_interrupt; external name 'RCC_CRS_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure TSC_interrupt; external name 'TSC_interrupt';
+procedure DMA1_Channel1_interrupt; external name 'DMA1_Channel1_interrupt';
+procedure DMA1_Channel2_3_interrupt; external name 'DMA1_Channel2_3_interrupt';
+procedure DMA1_Channel4_5_6_7_interrupt; external name 'DMA1_Channel4_5_6_7_interrupt';
+procedure ADC1_COMP_interrupt; external name 'ADC1_COMP_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM2_interrupt; external name 'TIM2_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM6_DAC_interrupt; external name 'TIM6_DAC_interrupt';
+procedure TIM7_interrupt; external name 'TIM7_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM15_interrupt; external name 'TIM15_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure I2C2_interrupt; external name 'I2C2_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure SPI2_interrupt; external name 'SPI2_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+procedure USART2_interrupt; external name 'USART2_interrupt';
+procedure USART3_4_interrupt; external name 'USART3_4_interrupt';
+procedure CEC_CAN_interrupt; external name 'CEC_CAN_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long PVD_VDDIO2_interrupt
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_CRS_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long TSC_interrupt
+  .long DMA1_Channel1_interrupt
+  .long DMA1_Channel2_3_interrupt
+  .long DMA1_Channel4_5_6_7_interrupt
+  .long ADC1_COMP_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long TIM2_interrupt
+  .long TIM3_interrupt
+  .long TIM6_DAC_interrupt
+  .long TIM7_interrupt
+  .long TIM14_interrupt
+  .long TIM15_interrupt
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long I2C2_interrupt
+  .long SPI1_interrupt
+  .long SPI2_interrupt
+  .long USART1_interrupt
+  .long USART2_interrupt
+  .long USART3_4_interrupt
+  .long CEC_CAN_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak PVD_VDDIO2_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_CRS_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak TSC_interrupt
+  .weak DMA1_Channel1_interrupt
+  .weak DMA1_Channel2_3_interrupt
+  .weak DMA1_Channel4_5_6_7_interrupt
+  .weak ADC1_COMP_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM2_interrupt
+  .weak TIM3_interrupt
+  .weak TIM6_DAC_interrupt
+  .weak TIM7_interrupt
+  .weak TIM14_interrupt
+  .weak TIM15_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak I2C2_interrupt
+  .weak SPI1_interrupt
+  .weak SPI2_interrupt
+  .weak USART1_interrupt
+  .weak USART2_interrupt
+  .weak USART3_4_interrupt
+  .weak CEC_CAN_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set PVD_VDDIO2_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_CRS_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set TSC_interrupt, HaltProc
+  .set DMA1_Channel1_interrupt, HaltProc
+  .set DMA1_Channel2_3_interrupt, HaltProc
+  .set DMA1_Channel4_5_6_7_interrupt, HaltProc
+  .set ADC1_COMP_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM2_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM6_DAC_interrupt, HaltProc
+  .set TIM7_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM15_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set I2C2_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set SPI2_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .set USART2_interrupt, HaltProc
+  .set USART3_4_interrupt, HaltProc
+  .set CEC_CAN_interrupt, HaltProc
+  .text
+end;
+end.
diff -Naur fpc-save/rtl/embedded/arm/stm32f072xb.pp fpc-build/rtl/embedded/arm/stm32f072xb.pp
--- fpc-save/rtl/embedded/arm/stm32f072xb.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f072xb.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,753 @@
+unit stm32f072xb;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f072xb.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    PVD_VDDIO2_IRQn = 1,              // PVD & VDDIO2 Interrupt through EXTI Lines 16 and 31
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_CRS_IRQn = 4,                 // RCC & CRS global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    TSC_IRQn   = 8,                   // Touch Sensing Controller Interrupts
+    DMA1_Channel1_IRQn = 9,           // DMA1 Channel 1 Interrupt
+    DMA1_Channel2_3_IRQn = 10,        // DMA1 Channel 2 and Channel 3 Interrupt
+    DMA1_Channel4_5_6_7_IRQn = 11,    // DMA1 Channel 4 to Channel 7 Interrupt
+    ADC1_COMP_IRQn = 12,              // ADC1 and COMP interrupts (ADC interrupt combined with EXTI Lines 21 and 22
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM2_IRQn  = 15,                  // TIM2 global Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM6_DAC_IRQn = 17,               // TIM6 global and DAC channel underrun error Interrupt
+    TIM7_IRQn  = 18,                  // TIM7 global Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM15_IRQn = 20,                  // TIM15 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt & EXTI Line23 Interrupt (I2C1 wakeup)
+    I2C2_IRQn  = 24,                  // I2C2 Event Interrupt
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    SPI2_IRQn  = 26,                  // SPI2 global Interrupt
+    USART1_IRQn = 27,                 // USART1 global Interrupt & EXTI Line25 Interrupt (USART1 wakeup)
+    USART2_IRQn = 28,                 // USART2 global Interrupt & EXTI Line26 Interrupt (USART2 wakeup)
+    USART3_4_IRQn = 29,               // USART3 and USART4 global Interrupt
+    CEC_CAN_IRQn = 30,                // CEC and CAN global Interrupts & EXTI Line27 Interrupt
+    USB_IRQn   = 31                   // USB global Interrupt  & EXTI Line18 Interrupt
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCAN_TXMAILBOX_Registers = record
+    TIR        : longword;            // CAN TX mailbox identifier register
+    TDTR       : longword;            // CAN mailbox data length control and time stamp register
+    TDLR       : longword;            // CAN mailbox data low register
+    TDHR       : longword;            // CAN mailbox data high register
+  end;
+
+  TCAN_FIFOMAILBOX_Registers = record
+    RIR        : longword;            // CAN receive FIFO mailbox identifier register
+    RDTR       : longword;            // CAN receive FIFO mailbox data length control and time stamp register
+    RDLR       : longword;            // CAN receive FIFO mailbox data low register
+    RDHR       : longword;            // CAN receive FIFO mailbox data high register
+  end;
+
+  TCAN_FILTERREGISTER_Registers = record
+    FR1        : longword;            // CAN Filter bank register 1
+    FR2        : longword;            // CAN Filter bank register 1
+  end;
+
+  TCAN_Registers = record
+    MCR        : longword;            // CAN master control register
+    MSR        : longword;            // CAN master status register
+    TSR        : longword;            // CAN transmit status register
+    RF0R       : longword;            // CAN receive FIFO 0 register
+    RF1R       : longword;            // CAN receive FIFO 1 register
+    IER        : longword;            // CAN interrupt enable register
+    ESR        : longword;            // CAN error status register
+    BTR        : longword;            // CAN bit timing register
+    RESERVED0  : array[0..87] of longword; // Reserved, 0x020 - 0x17F
+    sTxMailBox : array[0..2] of TCAN_TxMailBox_Registers; // CAN Tx MailBox
+    sFIFOMailBox : array[0..1] of TCAN_FIFOMailBox_Registers; // CAN FIFO MailBox
+    RESERVED1  : array[0..11] of longword; // Reserved, 0x1D0 - 0x1FF
+    FMR        : longword;            // CAN filter master register
+    FM1R       : longword;            // CAN filter mode register
+    RESERVED2  : longword;            // Reserved, 0x208
+    FS1R       : longword;            // CAN filter scale register
+    RESERVED3  : longword;            // Reserved, 0x210
+    FFA1R      : longword;            // CAN filter FIFO assignment register
+    RESERVED4  : longword;            // Reserved, 0x218
+    FA1R       : longword;            // CAN filter activation register
+    RESERVED5  : array[0..7] of longword; // Reserved, 0x220-0x23F
+    sFilterRegister : array[0..27] of TCAN_FilterRegister_Registers; // CAN Filter Register
+  end;
+
+  TCEC_Registers = record
+    CR         : longword;            // CEC control register
+    CFGR       : longword;            // CEC configuration register
+    TXDR       : longword;            // CEC Tx data register
+    RXDR       : longword;            // CEC Rx Data Register
+    ISR        : longword;            // CEC Interrupt and Status Register
+    IER        : longword;            // CEC interrupt enable register
+  end;
+
+  TCOMP_Registers = record
+    CSR        : word;                // COMP control and status register
+  end;
+
+  TCOMP_COMMON_Registers = record
+    CSR        : longword;            // COMP control and status register, used for bits common to several COMP instances
+  end;
+
+  TCOMP1_2_Registers = record
+    CSR        : longword;            // Kept for legacy purpose. Use structure 'COMP_Common_TypeDef'.
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    POL        : longword;            // CRC polynomial register
+  end;
+
+  TCRS_Registers = record
+    CR         : longword;            // CRS ccontrol register
+    CFGR       : longword;            // CRS configuration register
+    ISR        : longword;            // CRS interrupt and status register
+    ICR        : longword;            // CRS interrupt flag clear register
+  end;
+
+  TDAC_Registers = record
+    CR         : longword;            // DAC control register
+    SWTRIGR    : longword;            // DAC software trigger register
+    DHR12R1    : longword;            // DAC channel1 12-bit right-aligned data holding register
+    DHR12L1    : longword;            // DAC channel1 12-bit left aligned data holding register
+    DHR8R1     : longword;            // DAC channel1 8-bit right aligned data holding register
+    DHR12R2    : longword;            // DAC channel2 12-bit right aligned data holding register
+    DHR12L2    : longword;            // DAC channel2 12-bit left aligned data holding register
+    DHR8R2     : longword;            // DAC channel2 8-bit right-aligned data holding register
+    DHR12RD    : longword;            // Dual DAC 12-bit right-aligned data holding register
+    DHR12LD    : longword;            // DUAL DAC 12-bit left aligned data holding register
+    DHR8RD     : longword;            // DUAL DAC 8-bit right aligned data holding register
+    DOR1       : longword;            // DAC channel1 data output register
+    DOR2       : longword;            // DAC channel2 data output register
+    SR         : longword;            // DAC status register
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+    WRP1       : word;                // FLASH option byte write protection 1
+    WRP2       : word;                // FLASH option byte write protection 2
+    WRP3       : word;                // FLASH option byte write protection 3
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    WUTR       : longword;            // RTC wakeup timer register
+    RESERVED1  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED2  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+    RESERVED3  : longword;            // Reserved
+    RESERVED4  : longword;            // Reserved
+    BKP0R      : longword;            // RTC backup register 0
+    BKP1R      : longword;            // RTC backup register 1
+    BKP2R      : longword;            // RTC backup register 2
+    BKP3R      : longword;            // RTC backup register 3
+    BKP4R      : longword;            // RTC backup register 4
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+    I2SPR      : longword;            // SPI_I2S prescaler register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TTSC_Registers = record
+    CR         : longword;            // TSC control register
+    IER        : longword;            // TSC interrupt enable register
+    ICR        : longword;            // TSC interrupt clear register
+    ISR        : longword;            // TSC interrupt status register
+    IOHCR      : longword;            // TSC I/O hysteresis control register
+    RESERVED1  : longword;            // Reserved
+    IOASCR     : longword;            // TSC I/O analog switch control register
+    RESERVED2  : longword;            // Reserved
+    IOSCR      : longword;            // TSC I/O sampling control register
+    RESERVED3  : longword;            // Reserved
+    IOCCR      : longword;            // TSC I/O channel control register
+    RESERVED4  : longword;            // Reserved
+    IOGCSR     : longword;            // TSC I/O group control status register
+    IOGXCR     : array[0..7] of longword; // TSC I/O group x counter register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TUSB_Registers = record
+    EP0R       : word;                // USB Endpoint 0 register
+    RESERVED0  : word;                // Reserved
+    EP1R       : word;                // USB Endpoint 1 register
+    RESERVED1  : word;                // Reserved
+    EP2R       : word;                // USB Endpoint 2 register
+    RESERVED2  : word;                // Reserved
+    EP3R       : word;                // USB Endpoint 3 register
+    RESERVED3  : word;                // Reserved
+    EP4R       : word;                // USB Endpoint 4 register
+    RESERVED4  : word;                // Reserved
+    EP5R       : word;                // USB Endpoint 5 register
+    RESERVED5  : word;                // Reserved
+    EP6R       : word;                // USB Endpoint 6 register
+    RESERVED6  : word;                // Reserved
+    EP7R       : word;                // USB Endpoint 7 register
+    RESERVED7  : array[0..16] of word; // Reserved
+    CNTR       : word;                // Control register
+    RESERVED8  : word;                // Reserved
+    ISTR       : word;                // Interrupt status register
+    RESERVED9  : word;                // Reserved
+    FNR        : word;                // Frame number register
+    RESERVEDA  : word;                // Reserved
+    DADDR      : word;                // Device address register
+    RESERVEDB  : word;                // Reserved
+    BTABLE     : word;                // Buffer Table address register
+    RESERVEDC  : word;                // Reserved
+    LPMCSR     : word;                // LPM Control and Status register
+    RESERVEDD  : word;                // Reserved
+    BCDR       : word;                // Battery Charging detector register
+    RESERVEDE  : word;                // Reserved
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM2_BASE    = APBPERIPH_BASE + $00000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM6_BASE    = APBPERIPH_BASE + $00001000;
+  TIM7_BASE    = APBPERIPH_BASE + $00001400;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  SPI2_BASE    = APBPERIPH_BASE + $00003800;
+  USART2_BASE  = APBPERIPH_BASE + $00004400;
+  USART3_BASE  = APBPERIPH_BASE + $00004800;
+  USART4_BASE  = APBPERIPH_BASE + $00004C00;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  I2C2_BASE    = APBPERIPH_BASE + $00005800;
+  USB_BASE     = APBPERIPH_BASE + $00005C00; // USB_IP Peripheral Registers base address
+  CAN_BASE     = APBPERIPH_BASE + $00006400;
+  CRS_BASE     = APBPERIPH_BASE + $00006C00;
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  DAC_BASE     = APBPERIPH_BASE + $00007400;
+  CEC_BASE     = APBPERIPH_BASE + $00007800;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  COMP_BASE    = APBPERIPH_BASE + $0001001C;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM15_BASE   = APBPERIPH_BASE + $00014000;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  DMA1_Channel6_BASE = DMA1_BASE + $0000006C;
+  DMA1_Channel7_BASE = DMA1_BASE + $00000080;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  TSC_BASE     = AHBPERIPH_BASE + $00004000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOD_BASE   = AHB2PERIPH_BASE + $00000C00;
+  GPIOE_BASE   = AHB2PERIPH_BASE + $00001000;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM2         : TTIM_Registers absolute TIM2_BASE;
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM6         : TTIM_Registers absolute TIM6_BASE;
+  TIM7         : TTIM_Registers absolute TIM7_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  USART2       : TUSART_Registers absolute USART2_BASE;
+  USART3       : TUSART_Registers absolute USART3_BASE;
+  USART4       : TUSART_Registers absolute USART4_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  I2C2         : TI2C_Registers absolute I2C2_BASE;
+  CAN          : TCAN_Registers absolute CAN_BASE;
+  CRS          : TCRS_Registers absolute CRS_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  DAC1         : TDAC_Registers absolute DAC_BASE;
+  DAC          : TDAC_Registers absolute DAC_BASE; // Kept for legacy purpose
+  CEC          : TCEC_Registers absolute CEC_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  COMP1        : TCOMP_Registers absolute COMP_BASE;
+  COMP2        : TCOMP_Registers absolute $00000002;
+  COMP12_COMMON : TCOMP_Common_Registers absolute COMP_BASE;
+  COMP         : TCOMP1_2_Registers absolute COMP_BASE; // Kept for legacy purpose
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  SPI2         : TSPI_Registers absolute SPI2_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM15        : TTIM_Registers absolute TIM15_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  DMA1_Channel6 : TDMA_Channel_Registers absolute DMA1_Channel6_BASE;
+  DMA1_Channel7 : TDMA_Channel_Registers absolute DMA1_Channel7_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  TSC          : TTSC_Registers absolute TSC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOD        : TGPIO_Registers absolute GPIOD_BASE;
+  GPIOE        : TGPIO_Registers absolute GPIOE_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+  USB          : TUSB_Registers absolute USB_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure PVD_VDDIO2_interrupt; external name 'PVD_VDDIO2_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_CRS_interrupt; external name 'RCC_CRS_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure TSC_interrupt; external name 'TSC_interrupt';
+procedure DMA1_Channel1_interrupt; external name 'DMA1_Channel1_interrupt';
+procedure DMA1_Channel2_3_interrupt; external name 'DMA1_Channel2_3_interrupt';
+procedure DMA1_Channel4_5_6_7_interrupt; external name 'DMA1_Channel4_5_6_7_interrupt';
+procedure ADC1_COMP_interrupt; external name 'ADC1_COMP_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM2_interrupt; external name 'TIM2_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM6_DAC_interrupt; external name 'TIM6_DAC_interrupt';
+procedure TIM7_interrupt; external name 'TIM7_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM15_interrupt; external name 'TIM15_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure I2C2_interrupt; external name 'I2C2_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure SPI2_interrupt; external name 'SPI2_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+procedure USART2_interrupt; external name 'USART2_interrupt';
+procedure USART3_4_interrupt; external name 'USART3_4_interrupt';
+procedure CEC_CAN_interrupt; external name 'CEC_CAN_interrupt';
+procedure USB_interrupt; external name 'USB_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long PVD_VDDIO2_interrupt
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_CRS_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long TSC_interrupt
+  .long DMA1_Channel1_interrupt
+  .long DMA1_Channel2_3_interrupt
+  .long DMA1_Channel4_5_6_7_interrupt
+  .long ADC1_COMP_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long TIM2_interrupt
+  .long TIM3_interrupt
+  .long TIM6_DAC_interrupt
+  .long TIM7_interrupt
+  .long TIM14_interrupt
+  .long TIM15_interrupt
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long I2C2_interrupt
+  .long SPI1_interrupt
+  .long SPI2_interrupt
+  .long USART1_interrupt
+  .long USART2_interrupt
+  .long USART3_4_interrupt
+  .long CEC_CAN_interrupt
+  .long USB_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak PVD_VDDIO2_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_CRS_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak TSC_interrupt
+  .weak DMA1_Channel1_interrupt
+  .weak DMA1_Channel2_3_interrupt
+  .weak DMA1_Channel4_5_6_7_interrupt
+  .weak ADC1_COMP_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM2_interrupt
+  .weak TIM3_interrupt
+  .weak TIM6_DAC_interrupt
+  .weak TIM7_interrupt
+  .weak TIM14_interrupt
+  .weak TIM15_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak I2C2_interrupt
+  .weak SPI1_interrupt
+  .weak SPI2_interrupt
+  .weak USART1_interrupt
+  .weak USART2_interrupt
+  .weak USART3_4_interrupt
+  .weak CEC_CAN_interrupt
+  .weak USB_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set PVD_VDDIO2_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_CRS_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set TSC_interrupt, HaltProc
+  .set DMA1_Channel1_interrupt, HaltProc
+  .set DMA1_Channel2_3_interrupt, HaltProc
+  .set DMA1_Channel4_5_6_7_interrupt, HaltProc
+  .set ADC1_COMP_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM2_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM6_DAC_interrupt, HaltProc
+  .set TIM7_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM15_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set I2C2_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set SPI2_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .set USART2_interrupt, HaltProc
+  .set USART3_4_interrupt, HaltProc
+  .set CEC_CAN_interrupt, HaltProc
+  .set USB_interrupt, HaltProc
+  .text
+end;
+end.
diff -Naur fpc-save/rtl/embedded/arm/stm32f078xx.pp fpc-build/rtl/embedded/arm/stm32f078xx.pp
--- fpc-save/rtl/embedded/arm/stm32f078xx.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f078xx.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,753 @@
+unit stm32f078xx;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f078xx.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    VDDIO2_IRQn = 1,                  // VDDIO2 Interrupt through EXTI Line 31
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_CRS_IRQn = 4,                 // RCC & CRS global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    TSC_IRQn   = 8,                   // Touch Sensing Controller Interrupts
+    DMA1_Channel1_IRQn = 9,           // DMA1 Channel 1 Interrupt
+    DMA1_Channel2_3_IRQn = 10,        // DMA1 Channel 2 and Channel 3 Interrupt
+    DMA1_Channel4_5_6_7_IRQn = 11,    // DMA1 Channel 4 to Channel 7 Interrupt
+    ADC1_COMP_IRQn = 12,              // ADC1 and COMP interrupts (ADC interrupt combined with EXTI Lines 21 and 22
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM2_IRQn  = 15,                  // TIM2 global Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM6_DAC_IRQn = 17,               // TIM6 global and DAC channel underrun error Interrupt
+    TIM7_IRQn  = 18,                  // TIM7 global Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM15_IRQn = 20,                  // TIM15 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt & EXTI Line23 Interrupt (I2C1 wakeup)
+    I2C2_IRQn  = 24,                  // I2C2 Event Interrupt
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    SPI2_IRQn  = 26,                  // SPI2 global Interrupt
+    USART1_IRQn = 27,                 // USART1 global Interrupt & EXTI Line25 Interrupt (USART1 wakeup)
+    USART2_IRQn = 28,                 // USART2 global Interrupt & EXTI Line26 Interrupt (USART2 wakeup)
+    USART3_4_IRQn = 29,               // USART3 and USART4 global Interrupt
+    CEC_CAN_IRQn = 30,                // CEC and CAN global Interrupts & EXTI Line27 Interrupt
+    USB_IRQn   = 31                   // USB global Interrupt  & EXTI Line18 Interrupt
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCAN_TXMAILBOX_Registers = record
+    TIR        : longword;            // CAN TX mailbox identifier register
+    TDTR       : longword;            // CAN mailbox data length control and time stamp register
+    TDLR       : longword;            // CAN mailbox data low register
+    TDHR       : longword;            // CAN mailbox data high register
+  end;
+
+  TCAN_FIFOMAILBOX_Registers = record
+    RIR        : longword;            // CAN receive FIFO mailbox identifier register
+    RDTR       : longword;            // CAN receive FIFO mailbox data length control and time stamp register
+    RDLR       : longword;            // CAN receive FIFO mailbox data low register
+    RDHR       : longword;            // CAN receive FIFO mailbox data high register
+  end;
+
+  TCAN_FILTERREGISTER_Registers = record
+    FR1        : longword;            // CAN Filter bank register 1
+    FR2        : longword;            // CAN Filter bank register 1
+  end;
+
+  TCAN_Registers = record
+    MCR        : longword;            // CAN master control register
+    MSR        : longword;            // CAN master status register
+    TSR        : longword;            // CAN transmit status register
+    RF0R       : longword;            // CAN receive FIFO 0 register
+    RF1R       : longword;            // CAN receive FIFO 1 register
+    IER        : longword;            // CAN interrupt enable register
+    ESR        : longword;            // CAN error status register
+    BTR        : longword;            // CAN bit timing register
+    RESERVED0  : array[0..87] of longword; // Reserved, 0x020 - 0x17F
+    sTxMailBox : array[0..2] of TCAN_TxMailBox_Registers; // CAN Tx MailBox
+    sFIFOMailBox : array[0..1] of TCAN_FIFOMailBox_Registers; // CAN FIFO MailBox
+    RESERVED1  : array[0..11] of longword; // Reserved, 0x1D0 - 0x1FF
+    FMR        : longword;            // CAN filter master register
+    FM1R       : longword;            // CAN filter mode register
+    RESERVED2  : longword;            // Reserved, 0x208
+    FS1R       : longword;            // CAN filter scale register
+    RESERVED3  : longword;            // Reserved, 0x210
+    FFA1R      : longword;            // CAN filter FIFO assignment register
+    RESERVED4  : longword;            // Reserved, 0x218
+    FA1R       : longword;            // CAN filter activation register
+    RESERVED5  : array[0..7] of longword; // Reserved, 0x220-0x23F
+    sFilterRegister : array[0..27] of TCAN_FilterRegister_Registers; // CAN Filter Register
+  end;
+
+  TCEC_Registers = record
+    CR         : longword;            // CEC control register
+    CFGR       : longword;            // CEC configuration register
+    TXDR       : longword;            // CEC Tx data register
+    RXDR       : longword;            // CEC Rx Data Register
+    ISR        : longword;            // CEC Interrupt and Status Register
+    IER        : longword;            // CEC interrupt enable register
+  end;
+
+  TCOMP_Registers = record
+    CSR        : word;                // COMP control and status register
+  end;
+
+  TCOMP_COMMON_Registers = record
+    CSR        : longword;            // COMP control and status register, used for bits common to several COMP instances
+  end;
+
+  TCOMP1_2_Registers = record
+    CSR        : longword;            // Kept for legacy purpose. Use structure 'COMP_Common_TypeDef'.
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    POL        : longword;            // CRC polynomial register
+  end;
+
+  TCRS_Registers = record
+    CR         : longword;            // CRS ccontrol register
+    CFGR       : longword;            // CRS configuration register
+    ISR        : longword;            // CRS interrupt and status register
+    ICR        : longword;            // CRS interrupt flag clear register
+  end;
+
+  TDAC_Registers = record
+    CR         : longword;            // DAC control register
+    SWTRIGR    : longword;            // DAC software trigger register
+    DHR12R1    : longword;            // DAC channel1 12-bit right-aligned data holding register
+    DHR12L1    : longword;            // DAC channel1 12-bit left aligned data holding register
+    DHR8R1     : longword;            // DAC channel1 8-bit right aligned data holding register
+    DHR12R2    : longword;            // DAC channel2 12-bit right aligned data holding register
+    DHR12L2    : longword;            // DAC channel2 12-bit left aligned data holding register
+    DHR8R2     : longword;            // DAC channel2 8-bit right-aligned data holding register
+    DHR12RD    : longword;            // Dual DAC 12-bit right-aligned data holding register
+    DHR12LD    : longword;            // DUAL DAC 12-bit left aligned data holding register
+    DHR8RD     : longword;            // DUAL DAC 8-bit right aligned data holding register
+    DOR1       : longword;            // DAC channel1 data output register
+    DOR2       : longword;            // DAC channel2 data output register
+    SR         : longword;            // DAC status register
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+    WRP1       : word;                // FLASH option byte write protection 1
+    WRP2       : word;                // FLASH option byte write protection 2
+    WRP3       : word;                // FLASH option byte write protection 3
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    WUTR       : longword;            // RTC wakeup timer register
+    RESERVED1  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED2  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+    RESERVED3  : longword;            // Reserved
+    RESERVED4  : longword;            // Reserved
+    BKP0R      : longword;            // RTC backup register 0
+    BKP1R      : longword;            // RTC backup register 1
+    BKP2R      : longword;            // RTC backup register 2
+    BKP3R      : longword;            // RTC backup register 3
+    BKP4R      : longword;            // RTC backup register 4
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+    I2SPR      : longword;            // SPI_I2S prescaler register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TTSC_Registers = record
+    CR         : longword;            // TSC control register
+    IER        : longword;            // TSC interrupt enable register
+    ICR        : longword;            // TSC interrupt clear register
+    ISR        : longword;            // TSC interrupt status register
+    IOHCR      : longword;            // TSC I/O hysteresis control register
+    RESERVED1  : longword;            // Reserved
+    IOASCR     : longword;            // TSC I/O analog switch control register
+    RESERVED2  : longword;            // Reserved
+    IOSCR      : longword;            // TSC I/O sampling control register
+    RESERVED3  : longword;            // Reserved
+    IOCCR      : longword;            // TSC I/O channel control register
+    RESERVED4  : longword;            // Reserved
+    IOGCSR     : longword;            // TSC I/O group control status register
+    IOGXCR     : array[0..7] of longword; // TSC I/O group x counter register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TUSB_Registers = record
+    EP0R       : word;                // USB Endpoint 0 register
+    RESERVED0  : word;                // Reserved
+    EP1R       : word;                // USB Endpoint 1 register
+    RESERVED1  : word;                // Reserved
+    EP2R       : word;                // USB Endpoint 2 register
+    RESERVED2  : word;                // Reserved
+    EP3R       : word;                // USB Endpoint 3 register
+    RESERVED3  : word;                // Reserved
+    EP4R       : word;                // USB Endpoint 4 register
+    RESERVED4  : word;                // Reserved
+    EP5R       : word;                // USB Endpoint 5 register
+    RESERVED5  : word;                // Reserved
+    EP6R       : word;                // USB Endpoint 6 register
+    RESERVED6  : word;                // Reserved
+    EP7R       : word;                // USB Endpoint 7 register
+    RESERVED7  : array[0..16] of word; // Reserved
+    CNTR       : word;                // Control register
+    RESERVED8  : word;                // Reserved
+    ISTR       : word;                // Interrupt status register
+    RESERVED9  : word;                // Reserved
+    FNR        : word;                // Frame number register
+    RESERVEDA  : word;                // Reserved
+    DADDR      : word;                // Device address register
+    RESERVEDB  : word;                // Reserved
+    BTABLE     : word;                // Buffer Table address register
+    RESERVEDC  : word;                // Reserved
+    LPMCSR     : word;                // LPM Control and Status register
+    RESERVEDD  : word;                // Reserved
+    BCDR       : word;                // Battery Charging detector register
+    RESERVEDE  : word;                // Reserved
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM2_BASE    = APBPERIPH_BASE + $00000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM6_BASE    = APBPERIPH_BASE + $00001000;
+  TIM7_BASE    = APBPERIPH_BASE + $00001400;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  SPI2_BASE    = APBPERIPH_BASE + $00003800;
+  USART2_BASE  = APBPERIPH_BASE + $00004400;
+  USART3_BASE  = APBPERIPH_BASE + $00004800;
+  USART4_BASE  = APBPERIPH_BASE + $00004C00;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  I2C2_BASE    = APBPERIPH_BASE + $00005800;
+  USB_BASE     = APBPERIPH_BASE + $00005C00; // USB_IP Peripheral Registers base address
+  CAN_BASE     = APBPERIPH_BASE + $00006400;
+  CRS_BASE     = APBPERIPH_BASE + $00006C00;
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  DAC_BASE     = APBPERIPH_BASE + $00007400;
+  CEC_BASE     = APBPERIPH_BASE + $00007800;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  COMP_BASE    = APBPERIPH_BASE + $0001001C;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM15_BASE   = APBPERIPH_BASE + $00014000;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  DMA1_Channel6_BASE = DMA1_BASE + $0000006C;
+  DMA1_Channel7_BASE = DMA1_BASE + $00000080;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  TSC_BASE     = AHBPERIPH_BASE + $00004000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOD_BASE   = AHB2PERIPH_BASE + $00000C00;
+  GPIOE_BASE   = AHB2PERIPH_BASE + $00001000;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM2         : TTIM_Registers absolute TIM2_BASE;
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM6         : TTIM_Registers absolute TIM6_BASE;
+  TIM7         : TTIM_Registers absolute TIM7_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  USART2       : TUSART_Registers absolute USART2_BASE;
+  USART3       : TUSART_Registers absolute USART3_BASE;
+  USART4       : TUSART_Registers absolute USART4_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  I2C2         : TI2C_Registers absolute I2C2_BASE;
+  CAN          : TCAN_Registers absolute CAN_BASE;
+  CRS          : TCRS_Registers absolute CRS_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  DAC1         : TDAC_Registers absolute DAC_BASE;
+  DAC          : TDAC_Registers absolute DAC_BASE; // Kept for legacy purpose
+  CEC          : TCEC_Registers absolute CEC_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  COMP1        : TCOMP_Registers absolute COMP_BASE;
+  COMP2        : TCOMP_Registers absolute $00000002;
+  COMP12_COMMON : TCOMP_Common_Registers absolute COMP_BASE;
+  COMP         : TCOMP1_2_Registers absolute COMP_BASE; // Kept for legacy purpose
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  SPI2         : TSPI_Registers absolute SPI2_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM15        : TTIM_Registers absolute TIM15_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  DMA1_Channel6 : TDMA_Channel_Registers absolute DMA1_Channel6_BASE;
+  DMA1_Channel7 : TDMA_Channel_Registers absolute DMA1_Channel7_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  TSC          : TTSC_Registers absolute TSC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOD        : TGPIO_Registers absolute GPIOD_BASE;
+  GPIOE        : TGPIO_Registers absolute GPIOE_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+  USB          : TUSB_Registers absolute USB_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure VDDIO2_interrupt; external name 'VDDIO2_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_CRS_interrupt; external name 'RCC_CRS_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure TSC_interrupt; external name 'TSC_interrupt';
+procedure DMA1_Channel1_interrupt; external name 'DMA1_Channel1_interrupt';
+procedure DMA1_Channel2_3_interrupt; external name 'DMA1_Channel2_3_interrupt';
+procedure DMA1_Channel4_5_6_7_interrupt; external name 'DMA1_Channel4_5_6_7_interrupt';
+procedure ADC1_COMP_interrupt; external name 'ADC1_COMP_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM2_interrupt; external name 'TIM2_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM6_DAC_interrupt; external name 'TIM6_DAC_interrupt';
+procedure TIM7_interrupt; external name 'TIM7_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM15_interrupt; external name 'TIM15_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure I2C2_interrupt; external name 'I2C2_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure SPI2_interrupt; external name 'SPI2_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+procedure USART2_interrupt; external name 'USART2_interrupt';
+procedure USART3_4_interrupt; external name 'USART3_4_interrupt';
+procedure CEC_CAN_interrupt; external name 'CEC_CAN_interrupt';
+procedure USB_interrupt; external name 'USB_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long VDDIO2_interrupt
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_CRS_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long TSC_interrupt
+  .long DMA1_Channel1_interrupt
+  .long DMA1_Channel2_3_interrupt
+  .long DMA1_Channel4_5_6_7_interrupt
+  .long ADC1_COMP_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long TIM2_interrupt
+  .long TIM3_interrupt
+  .long TIM6_DAC_interrupt
+  .long TIM7_interrupt
+  .long TIM14_interrupt
+  .long TIM15_interrupt
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long I2C2_interrupt
+  .long SPI1_interrupt
+  .long SPI2_interrupt
+  .long USART1_interrupt
+  .long USART2_interrupt
+  .long USART3_4_interrupt
+  .long CEC_CAN_interrupt
+  .long USB_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak VDDIO2_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_CRS_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak TSC_interrupt
+  .weak DMA1_Channel1_interrupt
+  .weak DMA1_Channel2_3_interrupt
+  .weak DMA1_Channel4_5_6_7_interrupt
+  .weak ADC1_COMP_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM2_interrupt
+  .weak TIM3_interrupt
+  .weak TIM6_DAC_interrupt
+  .weak TIM7_interrupt
+  .weak TIM14_interrupt
+  .weak TIM15_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak I2C2_interrupt
+  .weak SPI1_interrupt
+  .weak SPI2_interrupt
+  .weak USART1_interrupt
+  .weak USART2_interrupt
+  .weak USART3_4_interrupt
+  .weak CEC_CAN_interrupt
+  .weak USB_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set VDDIO2_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_CRS_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set TSC_interrupt, HaltProc
+  .set DMA1_Channel1_interrupt, HaltProc
+  .set DMA1_Channel2_3_interrupt, HaltProc
+  .set DMA1_Channel4_5_6_7_interrupt, HaltProc
+  .set ADC1_COMP_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM2_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM6_DAC_interrupt, HaltProc
+  .set TIM7_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM15_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set I2C2_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set SPI2_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .set USART2_interrupt, HaltProc
+  .set USART3_4_interrupt, HaltProc
+  .set CEC_CAN_interrupt, HaltProc
+  .set USB_interrupt, HaltProc
+  .text
+end;
+end.
diff -Naur fpc-save/rtl/embedded/arm/stm32f091xc.pp fpc-build/rtl/embedded/arm/stm32f091xc.pp
--- fpc-save/rtl/embedded/arm/stm32f091xc.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f091xc.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,737 @@
+unit stm32f091xc;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f091xc.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    PVD_VDDIO2_IRQn = 1,              // PVD & VDDIO2 Interrupt through EXTI Lines 16 and 31
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_CRS_IRQn = 4,                 // RCC & CRS global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    TSC_IRQn   = 8,                   // Touch Sensing Controller Interrupts
+    DMA1_Ch1_IRQn = 9,                // DMA1 Channel 1 Interrupt
+    DMA1_Ch2_3_DMA2_Ch1_2_IRQn = 10,  // DMA1 Channel 2 and 3 & DMA2 Channel 1 and 2 Interrupts
+    DMA1_Ch4_7_DMA2_Ch3_5_IRQn = 11,  // DMA1 Channel 4 to 7 & DMA2 Channel 3 to 5 Interrupt
+    ADC1_COMP_IRQn = 12,              // ADC1 and COMP interrupts (ADC interrupt combined with EXTI Lines 21 and 22
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM2_IRQn  = 15,                  // TIM2 global Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM6_DAC_IRQn = 17,               // TIM6 global and DAC channel underrun error Interrupt
+    TIM7_IRQn  = 18,                  // TIM7 global Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM15_IRQn = 20,                  // TIM15 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt & EXTI Line23 Interrupt (I2C1 wakeup)
+    I2C2_IRQn  = 24,                  // I2C2 Event Interrupt
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    SPI2_IRQn  = 26,                  // SPI2 global Interrupt
+    USART1_IRQn = 27,                 // USART1 global Interrupt & EXTI Line25 Interrupt (USART1 wakeup)
+    USART2_IRQn = 28,                 // USART2 global Interrupt & EXTI Line26 Interrupt (USART2 wakeup)
+    USART3_8_IRQn = 29,               // USART3 to USART8 global Interrupt
+    CEC_CAN_IRQn = 30                 // CEC and CAN global Interrupts & EXTI Line27 Interrupt
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCAN_TXMAILBOX_Registers = record
+    TIR        : longword;            // CAN TX mailbox identifier register
+    TDTR       : longword;            // CAN mailbox data length control and time stamp register
+    TDLR       : longword;            // CAN mailbox data low register
+    TDHR       : longword;            // CAN mailbox data high register
+  end;
+
+  TCAN_FIFOMAILBOX_Registers = record
+    RIR        : longword;            // CAN receive FIFO mailbox identifier register
+    RDTR       : longword;            // CAN receive FIFO mailbox data length control and time stamp register
+    RDLR       : longword;            // CAN receive FIFO mailbox data low register
+    RDHR       : longword;            // CAN receive FIFO mailbox data high register
+  end;
+
+  TCAN_FILTERREGISTER_Registers = record
+    FR1        : longword;            // CAN Filter bank register 1
+    FR2        : longword;            // CAN Filter bank register 1
+  end;
+
+  TCAN_Registers = record
+    MCR        : longword;            // CAN master control register
+    MSR        : longword;            // CAN master status register
+    TSR        : longword;            // CAN transmit status register
+    RF0R       : longword;            // CAN receive FIFO 0 register
+    RF1R       : longword;            // CAN receive FIFO 1 register
+    IER        : longword;            // CAN interrupt enable register
+    ESR        : longword;            // CAN error status register
+    BTR        : longword;            // CAN bit timing register
+    RESERVED0  : array[0..87] of longword; // Reserved, 0x020 - 0x17F
+    sTxMailBox : array[0..2] of TCAN_TxMailBox_Registers; // CAN Tx MailBox
+    sFIFOMailBox : array[0..1] of TCAN_FIFOMailBox_Registers; // CAN FIFO MailBox
+    RESERVED1  : array[0..11] of longword; // Reserved, 0x1D0 - 0x1FF
+    FMR        : longword;            // CAN filter master register
+    FM1R       : longword;            // CAN filter mode register
+    RESERVED2  : longword;            // Reserved, 0x208
+    FS1R       : longword;            // CAN filter scale register
+    RESERVED3  : longword;            // Reserved, 0x210
+    FFA1R      : longword;            // CAN filter FIFO assignment register
+    RESERVED4  : longword;            // Reserved, 0x218
+    FA1R       : longword;            // CAN filter activation register
+    RESERVED5  : array[0..7] of longword; // Reserved, 0x220-0x23F
+    sFilterRegister : array[0..27] of TCAN_FilterRegister_Registers; // CAN Filter Register
+  end;
+
+  TCEC_Registers = record
+    CR         : longword;            // CEC control register
+    CFGR       : longword;            // CEC configuration register
+    TXDR       : longword;            // CEC Tx data register
+    RXDR       : longword;            // CEC Rx Data Register
+    ISR        : longword;            // CEC Interrupt and Status Register
+    IER        : longword;            // CEC interrupt enable register
+  end;
+
+  TCOMP_Registers = record
+    CSR        : word;                // COMP control and status register
+  end;
+
+  TCOMP_COMMON_Registers = record
+    CSR        : longword;            // COMP control and status register, used for bits common to several COMP instances
+  end;
+
+  TCOMP1_2_Registers = record
+    CSR        : longword;            // Kept for legacy purpose. Use structure 'COMP_Common_TypeDef'.
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    POL        : longword;            // CRC polynomial register
+  end;
+
+  TCRS_Registers = record
+    CR         : longword;            // CRS ccontrol register
+    CFGR       : longword;            // CRS configuration register
+    ISR        : longword;            // CRS interrupt and status register
+    ICR        : longword;            // CRS interrupt flag clear register
+  end;
+
+  TDAC_Registers = record
+    CR         : longword;            // DAC control register
+    SWTRIGR    : longword;            // DAC software trigger register
+    DHR12R1    : longword;            // DAC channel1 12-bit right-aligned data holding register
+    DHR12L1    : longword;            // DAC channel1 12-bit left aligned data holding register
+    DHR8R1     : longword;            // DAC channel1 8-bit right aligned data holding register
+    DHR12R2    : longword;            // DAC channel2 12-bit right aligned data holding register
+    DHR12L2    : longword;            // DAC channel2 12-bit left aligned data holding register
+    DHR8R2     : longword;            // DAC channel2 8-bit right-aligned data holding register
+    DHR12RD    : longword;            // Dual DAC 12-bit right-aligned data holding register
+    DHR12LD    : longword;            // DUAL DAC 12-bit left aligned data holding register
+    DHR8RD     : longword;            // DUAL DAC 8-bit right aligned data holding register
+    DOR1       : longword;            // DAC channel1 data output register
+    DOR2       : longword;            // DAC channel2 data output register
+    SR         : longword;            // DAC status register
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+    RESERVED0  : array[0..39] of longword; // Reserved as declared by channel typedef                   0x08 - 0xA4
+    CSELR      : longword;            // Channel selection register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+    WRP1       : word;                // FLASH option byte write protection 1
+    WRP2       : word;                // FLASH option byte write protection 2
+    WRP3       : word;                // FLASH option byte write protection 3
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+    RESERVED1  : array[0..24] of longword; // Reserved + COMP,                                                      0x1C
+    IT_LINE_SR : array[0..31] of longword; // SYSCFG configuration IT_LINE register
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    WUTR       : longword;            // RTC wakeup timer register
+    RESERVED1  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED2  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+    RESERVED3  : longword;            // Reserved
+    RESERVED4  : longword;            // Reserved
+    BKP0R      : longword;            // RTC backup register 0
+    BKP1R      : longword;            // RTC backup register 1
+    BKP2R      : longword;            // RTC backup register 2
+    BKP3R      : longword;            // RTC backup register 3
+    BKP4R      : longword;            // RTC backup register 4
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+    I2SPR      : longword;            // SPI_I2S prescaler register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TTSC_Registers = record
+    CR         : longword;            // TSC control register
+    IER        : longword;            // TSC interrupt enable register
+    ICR        : longword;            // TSC interrupt clear register
+    ISR        : longword;            // TSC interrupt status register
+    IOHCR      : longword;            // TSC I/O hysteresis control register
+    RESERVED1  : longword;            // Reserved
+    IOASCR     : longword;            // TSC I/O analog switch control register
+    RESERVED2  : longword;            // Reserved
+    IOSCR      : longword;            // TSC I/O sampling control register
+    RESERVED3  : longword;            // Reserved
+    IOCCR      : longword;            // TSC I/O channel control register
+    RESERVED4  : longword;            // Reserved
+    IOGCSR     : longword;            // TSC I/O group control status register
+    IOGXCR     : array[0..7] of longword; // TSC I/O group x counter register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM2_BASE    = APBPERIPH_BASE + $00000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM6_BASE    = APBPERIPH_BASE + $00001000;
+  TIM7_BASE    = APBPERIPH_BASE + $00001400;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  SPI2_BASE    = APBPERIPH_BASE + $00003800;
+  USART2_BASE  = APBPERIPH_BASE + $00004400;
+  USART3_BASE  = APBPERIPH_BASE + $00004800;
+  USART4_BASE  = APBPERIPH_BASE + $00004C00;
+  USART5_BASE  = APBPERIPH_BASE + $00005000;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  I2C2_BASE    = APBPERIPH_BASE + $00005800;
+  CAN_BASE     = APBPERIPH_BASE + $00006400;
+  CRS_BASE     = APBPERIPH_BASE + $00006C00;
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  DAC_BASE     = APBPERIPH_BASE + $00007400;
+  CEC_BASE     = APBPERIPH_BASE + $00007800;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  COMP_BASE    = APBPERIPH_BASE + $0001001C;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  USART6_BASE  = APBPERIPH_BASE + $00011400;
+  USART7_BASE  = APBPERIPH_BASE + $00011800;
+  USART8_BASE  = APBPERIPH_BASE + $00011C00;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM15_BASE   = APBPERIPH_BASE + $00014000;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  DMA1_Channel6_BASE = DMA1_BASE + $0000006C;
+  DMA1_Channel7_BASE = DMA1_BASE + $00000080;
+  DMA2_BASE    = AHBPERIPH_BASE + $00000400;
+  DMA2_Channel1_BASE = DMA2_BASE + $00000008;
+  DMA2_Channel2_BASE = DMA2_BASE + $0000001C;
+  DMA2_Channel3_BASE = DMA2_BASE + $00000030;
+  DMA2_Channel4_BASE = DMA2_BASE + $00000044;
+  DMA2_Channel5_BASE = DMA2_BASE + $00000058;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  TSC_BASE     = AHBPERIPH_BASE + $00004000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOD_BASE   = AHB2PERIPH_BASE + $00000C00;
+  GPIOE_BASE   = AHB2PERIPH_BASE + $00001000;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM2         : TTIM_Registers absolute TIM2_BASE;
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM6         : TTIM_Registers absolute TIM6_BASE;
+  TIM7         : TTIM_Registers absolute TIM7_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  USART2       : TUSART_Registers absolute USART2_BASE;
+  USART3       : TUSART_Registers absolute USART3_BASE;
+  USART4       : TUSART_Registers absolute USART4_BASE;
+  USART5       : TUSART_Registers absolute USART5_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  I2C2         : TI2C_Registers absolute I2C2_BASE;
+  CAN          : TCAN_Registers absolute CAN_BASE;
+  CRS          : TCRS_Registers absolute CRS_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  DAC1         : TDAC_Registers absolute DAC_BASE;
+  DAC          : TDAC_Registers absolute DAC_BASE; // Kept for legacy purpose
+  CEC          : TCEC_Registers absolute CEC_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  COMP1        : TCOMP_Registers absolute COMP_BASE;
+  COMP2        : TCOMP_Registers absolute $00000002;
+  COMP12_COMMON : TCOMP_Common_Registers absolute COMP_BASE;
+  COMP         : TCOMP1_2_Registers absolute COMP_BASE; // Kept for legacy purpose
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  USART6       : TUSART_Registers absolute USART6_BASE;
+  USART7       : TUSART_Registers absolute USART7_BASE;
+  USART8       : TUSART_Registers absolute USART8_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  SPI2         : TSPI_Registers absolute SPI2_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM15        : TTIM_Registers absolute TIM15_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  DMA1_Channel6 : TDMA_Channel_Registers absolute DMA1_Channel6_BASE;
+  DMA1_Channel7 : TDMA_Channel_Registers absolute DMA1_Channel7_BASE;
+  DMA2         : TDMA_Registers absolute DMA2_BASE;
+  DMA2_Channel1 : TDMA_Channel_Registers absolute DMA2_Channel1_BASE;
+  DMA2_Channel2 : TDMA_Channel_Registers absolute DMA2_Channel2_BASE;
+  DMA2_Channel3 : TDMA_Channel_Registers absolute DMA2_Channel3_BASE;
+  DMA2_Channel4 : TDMA_Channel_Registers absolute DMA2_Channel4_BASE;
+  DMA2_Channel5 : TDMA_Channel_Registers absolute DMA2_Channel5_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  TSC          : TTSC_Registers absolute TSC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOD        : TGPIO_Registers absolute GPIOD_BASE;
+  GPIOE        : TGPIO_Registers absolute GPIOE_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure PVD_VDDIO2_interrupt; external name 'PVD_VDDIO2_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_CRS_interrupt; external name 'RCC_CRS_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure TSC_interrupt; external name 'TSC_interrupt';
+procedure DMA1_Ch1_interrupt; external name 'DMA1_Ch1_interrupt';
+procedure DMA1_Ch2_3_DMA2_Ch1_2_interrupt; external name 'DMA1_Ch2_3_DMA2_Ch1_2_interrupt';
+procedure DMA1_Ch4_7_DMA2_Ch3_5_interrupt; external name 'DMA1_Ch4_7_DMA2_Ch3_5_interrupt';
+procedure ADC1_COMP_interrupt; external name 'ADC1_COMP_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM2_interrupt; external name 'TIM2_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM6_DAC_interrupt; external name 'TIM6_DAC_interrupt';
+procedure TIM7_interrupt; external name 'TIM7_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM15_interrupt; external name 'TIM15_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure I2C2_interrupt; external name 'I2C2_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure SPI2_interrupt; external name 'SPI2_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+procedure USART2_interrupt; external name 'USART2_interrupt';
+procedure USART3_8_interrupt; external name 'USART3_8_interrupt';
+procedure CEC_CAN_interrupt; external name 'CEC_CAN_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long PVD_VDDIO2_interrupt
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_CRS_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long TSC_interrupt
+  .long DMA1_Ch1_interrupt
+  .long DMA1_Ch2_3_DMA2_Ch1_2_interrupt
+  .long DMA1_Ch4_7_DMA2_Ch3_5_interrupt
+  .long ADC1_COMP_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long TIM2_interrupt
+  .long TIM3_interrupt
+  .long TIM6_DAC_interrupt
+  .long TIM7_interrupt
+  .long TIM14_interrupt
+  .long TIM15_interrupt
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long I2C2_interrupt
+  .long SPI1_interrupt
+  .long SPI2_interrupt
+  .long USART1_interrupt
+  .long USART2_interrupt
+  .long USART3_8_interrupt
+  .long CEC_CAN_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak PVD_VDDIO2_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_CRS_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak TSC_interrupt
+  .weak DMA1_Ch1_interrupt
+  .weak DMA1_Ch2_3_DMA2_Ch1_2_interrupt
+  .weak DMA1_Ch4_7_DMA2_Ch3_5_interrupt
+  .weak ADC1_COMP_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM2_interrupt
+  .weak TIM3_interrupt
+  .weak TIM6_DAC_interrupt
+  .weak TIM7_interrupt
+  .weak TIM14_interrupt
+  .weak TIM15_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak I2C2_interrupt
+  .weak SPI1_interrupt
+  .weak SPI2_interrupt
+  .weak USART1_interrupt
+  .weak USART2_interrupt
+  .weak USART3_8_interrupt
+  .weak CEC_CAN_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set PVD_VDDIO2_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_CRS_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set TSC_interrupt, HaltProc
+  .set DMA1_Ch1_interrupt, HaltProc
+  .set DMA1_Ch2_3_DMA2_Ch1_2_interrupt, HaltProc
+  .set DMA1_Ch4_7_DMA2_Ch3_5_interrupt, HaltProc
+  .set ADC1_COMP_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM2_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM6_DAC_interrupt, HaltProc
+  .set TIM7_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM15_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set I2C2_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set SPI2_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .set USART2_interrupt, HaltProc
+  .set USART3_8_interrupt, HaltProc
+  .set CEC_CAN_interrupt, HaltProc
+  .text
+end;
+end.
diff -Naur fpc-save/rtl/embedded/arm/stm32f098xx.pp fpc-build/rtl/embedded/arm/stm32f098xx.pp
--- fpc-save/rtl/embedded/arm/stm32f098xx.pp	1970-01-01 01:00:00.000000000 +0100
+++ fpc-build/rtl/embedded/arm/stm32f098xx.pp	2018-03-02 16:31:58.000000000 +0100
@@ -0,0 +1,737 @@
+unit stm32f098xx;
+interface
+{$PACKRECORDS C}
+{$GOTO ON}
+// *
+// ******************************************************************************
+// * @file    stm32f098xx.h
+// * @author  MCD Application Team
+//   CMSIS Cortex-M0 Device Peripheral Access Layer Header File.
+// *          This file contains all the peripheral register's definitions, bits
+// *          definitions and memory mapping for STM32F0xx devices.
+// *
+// *          This file contains:
+// *           - Data structures and the address mapping for all peripherals
+// *           - Peripheral's registers declarations and bits definition
+// *           - Macros to access peripheral’s registers hardware
+// *
+// ******************************************************************************
+// * @attention
+// *
+// * <h2><center>&copy; COPYRIGHT(c) 2016 STMicroelectronics</center></h2>
+// *
+// * Redistribution and use in source and binary forms, with or without modification,
+// * are permitted provided that the following conditions are met:
+// *   1. Redistributions of source code must retain the above copyright notice,
+// *      this list of conditions and the following disclaimer.
+// *   2. Redistributions in binary form must reproduce the above copyright notice,
+// *      this list of conditions and the following disclaimer in the documentation
+// *      and/or other materials provided with the distribution.
+// *   3. Neither the name of STMicroelectronics nor the names of its contributors
+// *      may be used to endorse or promote products derived from this software
+// *      without specific prior written permission.
+// *
+// * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
+// * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+// * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+// * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
+// * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+// * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+// * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+// * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+// * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+// * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+// *
+// ******************************************************************************
+// Configuration of the Cortex-M0 Processor and Core Peripherals
+// STM32F0xx Interrupt Number Definition, according to the selected device
+// *        in @ref Library_configuration_section
+// Interrupt Number Definition
+
+type
+  TIRQn_Enum   = (
+    NonMaskableInt_IRQn = -14,        // 2 Non Maskable Interrupt
+    HardFault_IRQn = -13,             // 3 Cortex-M0 Hard Fault Interrupt
+    SVC_IRQn   = -5,                  // 11 Cortex-M0 SV Call Interrupt
+    PendSV_IRQn = -2,                 // 14 Cortex-M0 Pend SV Interrupt
+    SysTick_IRQn = -1,                // 15 Cortex-M0 System Tick Interrupt
+    WWDG_IRQn  = 0,                   // Window WatchDog Interrupt
+    VDDIO2_IRQn = 1,                  // VDDIO2 Interrupt through EXTI Line 31
+    RTC_IRQn   = 2,                   // RTC Interrupt through EXTI Lines 17, 19 and 20
+    FLASH_IRQn = 3,                   // FLASH global Interrupt
+    RCC_CRS_IRQn = 4,                 // RCC & CRS global Interrupt
+    EXTI0_1_IRQn = 5,                 // EXTI Line 0 and 1 Interrupt
+    EXTI2_3_IRQn = 6,                 // EXTI Line 2 and 3 Interrupt
+    EXTI4_15_IRQn = 7,                // EXTI Line 4 to 15 Interrupt
+    TSC_IRQn   = 8,                   // Touch Sensing Controller Interrupts
+    DMA1_Ch1_IRQn = 9,                // DMA1 Channel 1 Interrupt
+    DMA1_Ch2_3_DMA2_Ch1_2_IRQn = 10,  // DMA1 Channel 2 and 3 & DMA2 Channel 1 and 2 Interrupts
+    DMA1_Ch4_7_DMA2_Ch3_5_IRQn = 11,  // DMA1 Channel 4 to 7 & DMA2 Channel 3 to 5 Interrupt
+    ADC1_COMP_IRQn = 12,              // ADC1 and COMP interrupts (ADC interrupt combined with EXTI Lines 21 and 22
+    TIM1_BRK_UP_TRG_COM_IRQn = 13,    // TIM1 Break, Update, Trigger and Commutation Interrupt
+    TIM1_CC_IRQn = 14,                // TIM1 Capture Compare Interrupt
+    TIM2_IRQn  = 15,                  // TIM2 global Interrupt
+    TIM3_IRQn  = 16,                  // TIM3 global Interrupt
+    TIM6_DAC_IRQn = 17,               // TIM6 global and DAC channel underrun error Interrupt
+    TIM7_IRQn  = 18,                  // TIM7 global Interrupt
+    TIM14_IRQn = 19,                  // TIM14 global Interrupt
+    TIM15_IRQn = 20,                  // TIM15 global Interrupt
+    TIM16_IRQn = 21,                  // TIM16 global Interrupt
+    TIM17_IRQn = 22,                  // TIM17 global Interrupt
+    I2C1_IRQn  = 23,                  // I2C1 Event Interrupt & EXTI Line23 Interrupt (I2C1 wakeup)
+    I2C2_IRQn  = 24,                  // I2C2 Event Interrupt
+    SPI1_IRQn  = 25,                  // SPI1 global Interrupt
+    SPI2_IRQn  = 26,                  // SPI2 global Interrupt
+    USART1_IRQn = 27,                 // USART1 global Interrupt & EXTI Line25 Interrupt (USART1 wakeup)
+    USART2_IRQn = 28,                 // USART2 global Interrupt & EXTI Line26 Interrupt (USART2 wakeup)
+    USART3_8_IRQn = 29,               // USART3 to USART8 global Interrupt
+    CEC_CAN_IRQn = 30                 // CEC and CAN global Interrupts & EXTI Line27 Interrupt
+  );
+
+  TADC_Registers = record
+    ISR        : longword;            // ADC interrupt and status register
+    IER        : longword;            // ADC interrupt enable register
+    CR         : longword;            // ADC control register
+    CFGR1      : longword;            // ADC configuration register 1
+    CFGR2      : longword;            // ADC configuration register 2
+    SMPR       : longword;            // ADC sampling time register
+    RESERVED1  : longword;            // Reserved,                                                      0x18
+    RESERVED2  : longword;            // Reserved,                                                      0x1C
+    TR         : longword;            // ADC analog watchdog 1 threshold register
+    RESERVED3  : longword;            // Reserved,                                                      0x24
+    CHSELR     : longword;            // ADC group regular sequencer register
+    RESERVED4  : array[0..4] of longword; // Reserved,                                                      0x2C
+    DR         : longword;            // ADC group regular data register
+  end;
+
+  TADC_COMMON_Registers = record
+    CCR        : longword;            // ADC common configuration register
+  end;
+
+  TCAN_TXMAILBOX_Registers = record
+    TIR        : longword;            // CAN TX mailbox identifier register
+    TDTR       : longword;            // CAN mailbox data length control and time stamp register
+    TDLR       : longword;            // CAN mailbox data low register
+    TDHR       : longword;            // CAN mailbox data high register
+  end;
+
+  TCAN_FIFOMAILBOX_Registers = record
+    RIR        : longword;            // CAN receive FIFO mailbox identifier register
+    RDTR       : longword;            // CAN receive FIFO mailbox data length control and time stamp register
+    RDLR       : longword;            // CAN receive FIFO mailbox data low register
+    RDHR       : longword;            // CAN receive FIFO mailbox data high register
+  end;
+
+  TCAN_FILTERREGISTER_Registers = record
+    FR1        : longword;            // CAN Filter bank register 1
+    FR2        : longword;            // CAN Filter bank register 1
+  end;
+
+  TCAN_Registers = record
+    MCR        : longword;            // CAN master control register
+    MSR        : longword;            // CAN master status register
+    TSR        : longword;            // CAN transmit status register
+    RF0R       : longword;            // CAN receive FIFO 0 register
+    RF1R       : longword;            // CAN receive FIFO 1 register
+    IER        : longword;            // CAN interrupt enable register
+    ESR        : longword;            // CAN error status register
+    BTR        : longword;            // CAN bit timing register
+    RESERVED0  : array[0..87] of longword; // Reserved, 0x020 - 0x17F
+    sTxMailBox : array[0..2] of TCAN_TxMailBox_Registers; // CAN Tx MailBox
+    sFIFOMailBox : array[0..1] of TCAN_FIFOMailBox_Registers; // CAN FIFO MailBox
+    RESERVED1  : array[0..11] of longword; // Reserved, 0x1D0 - 0x1FF
+    FMR        : longword;            // CAN filter master register
+    FM1R       : longword;            // CAN filter mode register
+    RESERVED2  : longword;            // Reserved, 0x208
+    FS1R       : longword;            // CAN filter scale register
+    RESERVED3  : longword;            // Reserved, 0x210
+    FFA1R      : longword;            // CAN filter FIFO assignment register
+    RESERVED4  : longword;            // Reserved, 0x218
+    FA1R       : longword;            // CAN filter activation register
+    RESERVED5  : array[0..7] of longword; // Reserved, 0x220-0x23F
+    sFilterRegister : array[0..27] of TCAN_FilterRegister_Registers; // CAN Filter Register
+  end;
+
+  TCEC_Registers = record
+    CR         : longword;            // CEC control register
+    CFGR       : longword;            // CEC configuration register
+    TXDR       : longword;            // CEC Tx data register
+    RXDR       : longword;            // CEC Rx Data Register
+    ISR        : longword;            // CEC Interrupt and Status Register
+    IER        : longword;            // CEC interrupt enable register
+  end;
+
+  TCOMP_Registers = record
+    CSR        : word;                // COMP control and status register
+  end;
+
+  TCOMP_COMMON_Registers = record
+    CSR        : longword;            // COMP control and status register, used for bits common to several COMP instances
+  end;
+
+  TCOMP1_2_Registers = record
+    CSR        : longword;            // Kept for legacy purpose. Use structure 'COMP_Common_TypeDef'.
+  end;
+
+  TCRC_Registers = record
+    DR         : longword;            // CRC Data register
+    IDR        : byte;                // CRC Independent data register
+    RESERVED0  : byte;                // Reserved,                                                    0x05
+    RESERVED1  : word;                // Reserved,                                                    0x06
+    CR         : longword;            // CRC Control register
+    RESERVED2  : longword;            // Reserved,                                                    0x0C
+    INIT       : longword;            // Initial CRC value register
+    POL        : longword;            // CRC polynomial register
+  end;
+
+  TCRS_Registers = record
+    CR         : longword;            // CRS ccontrol register
+    CFGR       : longword;            // CRS configuration register
+    ISR        : longword;            // CRS interrupt and status register
+    ICR        : longword;            // CRS interrupt flag clear register
+  end;
+
+  TDAC_Registers = record
+    CR         : longword;            // DAC control register
+    SWTRIGR    : longword;            // DAC software trigger register
+    DHR12R1    : longword;            // DAC channel1 12-bit right-aligned data holding register
+    DHR12L1    : longword;            // DAC channel1 12-bit left aligned data holding register
+    DHR8R1     : longword;            // DAC channel1 8-bit right aligned data holding register
+    DHR12R2    : longword;            // DAC channel2 12-bit right aligned data holding register
+    DHR12L2    : longword;            // DAC channel2 12-bit left aligned data holding register
+    DHR8R2     : longword;            // DAC channel2 8-bit right-aligned data holding register
+    DHR12RD    : longword;            // Dual DAC 12-bit right-aligned data holding register
+    DHR12LD    : longword;            // DUAL DAC 12-bit left aligned data holding register
+    DHR8RD     : longword;            // DUAL DAC 8-bit right aligned data holding register
+    DOR1       : longword;            // DAC channel1 data output register
+    DOR2       : longword;            // DAC channel2 data output register
+    SR         : longword;            // DAC status register
+  end;
+
+  TDBGMCU_Registers = record
+    IDCODE     : longword;            // MCU device ID code
+    CR         : longword;            // Debug MCU configuration register
+    APB1FZ     : longword;            // Debug MCU APB1 freeze register
+    APB2FZ     : longword;            // Debug MCU APB2 freeze register
+  end;
+
+  TDMA_CHANNEL_Registers = record
+    CCR        : longword;            // DMA channel x configuration register
+    CNDTR      : longword;            // DMA channel x number of data register
+    CPAR       : longword;            // DMA channel x peripheral address register
+    CMAR       : longword;            // DMA channel x memory address register
+  end;
+
+  TDMA_Registers = record
+    ISR        : longword;            // DMA interrupt status register
+    IFCR       : longword;            // DMA interrupt flag clear register
+    RESERVED0  : array[0..39] of longword; // Reserved as declared by channel typedef                   0x08 - 0xA4
+    CSELR      : longword;            // Channel selection register
+  end;
+
+  TEXTI_Registers = record
+    IMR        : longword;            // XTI Interrupt mask register
+    EMR        : longword;            // XTI Event mask register
+    RTSR       : longword;            // XTI Rising trigger selection register
+    FTSR       : longword;            // XTI Falling trigger selection register
+    SWIER      : longword;            // XTI Software interrupt event register
+    PR         : longword;            // XTI Pending register
+  end;
+
+  TFLASH_Registers = record
+    ACR        : longword;            // LASH access control register
+    KEYR       : longword;            // LASH key register
+    OPTKEYR    : longword;            // LASH OPT key register
+    SR         : longword;            // LASH status register
+    CR         : longword;            // LASH control register
+    AR         : longword;            // LASH address register
+    RESERVED   : longword;            // Reserved,                                                     0x18
+    OBR        : longword;            // LASH option bytes register
+    WRPR       : longword;            // LASH option bytes register
+  end;
+
+  TOB_Registers = record
+    RDP        : word;                // FLASH option byte Read protection
+    USER       : word;                // FLASH option byte user options
+    DATA0      : word;                // User data byte 0 (stored in FLASH_OBR[23:16])
+    DATA1      : word;                // User data byte 1 (stored in FLASH_OBR[31:24])
+    WRP0       : word;                // FLASH option byte write protection 0
+    WRP1       : word;                // FLASH option byte write protection 1
+    WRP2       : word;                // FLASH option byte write protection 2
+    WRP3       : word;                // FLASH option byte write protection 3
+  end;
+
+  TGPIO_Registers = record
+    MODER      : longword;            // GPIO port mode register
+    OTYPER     : longword;            // GPIO port output type register
+    OSPEEDR    : longword;            // GPIO port output speed register
+    PUPDR      : longword;            // GPIO port pull-up/pull-down register
+    IDR        : longword;            // GPIO port input data register
+    ODR        : longword;            // GPIO port output data register
+    BSRR       : longword;            // GPIO port bit set/reset register
+    LCKR       : longword;            // GPIO port configuration lock register
+    AFR        : array[0..1] of longword; // GPIO alternate function low register
+    BRR        : longword;            // GPIO bit reset register
+  end;
+
+  TSYSCFG_Registers = record
+    CFGR1      : longword;            // SYSCFG configuration register 1
+    RESERVED   : longword;            // Reserved,                                                                  0x04
+    EXTICR     : array[0..3] of longword; // SYSCFG external interrupt configuration register
+    CFGR2      : longword;            // SYSCFG configuration register 2
+    RESERVED1  : array[0..24] of longword; // Reserved + COMP,                                                      0x1C
+    IT_LINE_SR : array[0..31] of longword; // SYSCFG configuration IT_LINE register
+  end;
+
+  TI2C_Registers = record
+    CR1        : longword;            // I2C Control register 1
+    CR2        : longword;            // I2C Control register 2
+    OAR1       : longword;            // I2C Own address 1 register
+    OAR2       : longword;            // I2C Own address 2 register
+    TIMINGR    : longword;            // I2C Timing register
+    TIMEOUTR   : longword;            // I2C Timeout register
+    ISR        : longword;            // I2C Interrupt and status register
+    ICR        : longword;            // I2C Interrupt clear register
+    PECR       : longword;            // I2C PEC register
+    RXDR       : longword;            // I2C Receive data register
+    TXDR       : longword;            // I2C Transmit data register
+  end;
+
+  TIWDG_Registers = record
+    KR         : longword;            // IWDG Key register
+    PR         : longword;            // IWDG Prescaler register
+    RLR        : longword;            // IWDG Reload register
+    SR         : longword;            // IWDG Status register
+    WINR       : longword;            // IWDG Window register
+  end;
+
+  TPWR_Registers = record
+    CR         : longword;            // PWR power control register
+    CSR        : longword;            // PWR power control/status register
+  end;
+
+  TRCC_Registers = record
+    CR         : longword;            // RCC clock control register
+    CFGR       : longword;            // RCC clock configuration register
+    CIR        : longword;            // RCC clock interrupt register
+    APB2RSTR   : longword;            // RCC APB2 peripheral reset register
+    APB1RSTR   : longword;            // RCC APB1 peripheral reset register
+    AHBENR     : longword;            // RCC AHB peripheral clock register
+    APB2ENR    : longword;            // RCC APB2 peripheral clock enable register
+    APB1ENR    : longword;            // RCC APB1 peripheral clock enable register
+    BDCR       : longword;            // RCC Backup domain control register
+    CSR        : longword;            // RCC clock control & status register
+    AHBRSTR    : longword;            // RCC AHB peripheral reset register
+    CFGR2      : longword;            // RCC clock configuration register 2
+    CFGR3      : longword;            // RCC clock configuration register 3
+    CR2        : longword;            // RCC clock control register 2
+  end;
+
+  TRTC_Registers = record
+    TR         : longword;            // RTC time register
+    DR         : longword;            // RTC date register
+    CR         : longword;            // RTC control register
+    ISR        : longword;            // RTC initialization and status register
+    PRER       : longword;            // RTC prescaler register
+    WUTR       : longword;            // RTC wakeup timer register
+    RESERVED1  : longword;            // Reserved
+    ALRMAR     : longword;            // RTC alarm A register
+    RESERVED2  : longword;            // Reserved
+    WPR        : longword;            // RTC write protection register
+    SSR        : longword;            // RTC sub second register
+    SHIFTR     : longword;            // RTC shift control register
+    TSTR       : longword;            // RTC time stamp time register
+    TSDR       : longword;            // RTC time stamp date register
+    TSSSR      : longword;            // RTC time-stamp sub second register
+    CALR       : longword;            // RTC calibration register
+    TAFCR      : longword;            // RTC tamper and alternate function configuration register
+    ALRMASSR   : longword;            // RTC alarm A sub second register
+    RESERVED3  : longword;            // Reserved
+    RESERVED4  : longword;            // Reserved
+    BKP0R      : longword;            // RTC backup register 0
+    BKP1R      : longword;            // RTC backup register 1
+    BKP2R      : longword;            // RTC backup register 2
+    BKP3R      : longword;            // RTC backup register 3
+    BKP4R      : longword;            // RTC backup register 4
+  end;
+
+  TSPI_Registers = record
+    CR1        : longword;            // SPI Control register 1 (not used in I2S mode)
+    CR2        : longword;            // SPI Control register 2
+    SR         : longword;            // SPI Status register
+    DR         : longword;            // SPI data register
+    CRCPR      : longword;            // SPI CRC polynomial register (not used in I2S mode)
+    RXCRCR     : longword;            // SPI Rx CRC register (not used in I2S mode)
+    TXCRCR     : longword;            // SPI Tx CRC register (not used in I2S mode)
+    I2SCFGR    : longword;            // SPI_I2S configuration register
+    I2SPR      : longword;            // SPI_I2S prescaler register
+  end;
+
+  TTIM_Registers = record
+    CR1        : longword;            // TIM control register 1
+    CR2        : longword;            // TIM control register 2
+    SMCR       : longword;            // TIM slave Mode Control register
+    DIER       : longword;            // TIM DMA/interrupt enable register
+    SR         : longword;            // TIM status register
+    EGR        : longword;            // TIM event generation register
+    CCMR1      : longword;            // TIM capture/compare mode register 1
+    CCMR2      : longword;            // TIM capture/compare mode register 2
+    CCER       : longword;            // TIM capture/compare enable register
+    CNT        : longword;            // TIM counter register
+    PSC        : longword;            // TIM prescaler register
+    ARR        : longword;            // TIM auto-reload register
+    RCR        : longword;            // TIM  repetition counter register
+    CCR1       : longword;            // TIM capture/compare register 1
+    CCR2       : longword;            // TIM capture/compare register 2
+    CCR3       : longword;            // TIM capture/compare register 3
+    CCR4       : longword;            // TIM capture/compare register 4
+    BDTR       : longword;            // TIM break and dead-time register
+    DCR        : longword;            // TIM DMA control register
+    DMAR       : longword;            // TIM DMA address for full transfer register
+    &OR        : longword;            // TIM option register
+  end;
+
+  TTSC_Registers = record
+    CR         : longword;            // TSC control register
+    IER        : longword;            // TSC interrupt enable register
+    ICR        : longword;            // TSC interrupt clear register
+    ISR        : longword;            // TSC interrupt status register
+    IOHCR      : longword;            // TSC I/O hysteresis control register
+    RESERVED1  : longword;            // Reserved
+    IOASCR     : longword;            // TSC I/O analog switch control register
+    RESERVED2  : longword;            // Reserved
+    IOSCR      : longword;            // TSC I/O sampling control register
+    RESERVED3  : longword;            // Reserved
+    IOCCR      : longword;            // TSC I/O channel control register
+    RESERVED4  : longword;            // Reserved
+    IOGCSR     : longword;            // TSC I/O group control status register
+    IOGXCR     : array[0..7] of longword; // TSC I/O group x counter register
+  end;
+
+  TUSART_Registers = record
+    CR1        : longword;            // USART Control register 1
+    CR2        : longword;            // USART Control register 2
+    CR3        : longword;            // USART Control register 3
+    BRR        : longword;            // USART Baud rate register
+    GTPR       : longword;            // USART Guard time and prescaler register
+    RTOR       : longword;            // USART Receiver Time Out register
+    RQR        : longword;            // USART Request register
+    ISR        : longword;            // USART Interrupt and status register
+    ICR        : longword;            // USART Interrupt flag Clear register
+    RDR        : word;                // USART Receive Data register
+    RESERVED1  : word;                // Reserved, 0x26
+    TDR        : word;                // USART Transmit Data register
+    RESERVED2  : word;                // Reserved, 0x2A
+  end;
+
+  TWWDG_Registers = record
+    CR         : longword;            // WWDG Control register
+    CFR        : longword;            // WWDG Configuration register
+    SR         : longword;            // WWDG Status register
+  end;
+
+const
+  FLASH_BASE   = $08000000;           // FLASH base address in the alias region
+  SRAM_BASE    = $20000000;           // SRAM base address in the alias region
+  PERIPH_BASE  = $40000000;           // Peripheral base address in the alias region
+  APBPERIPH_BASE = $40000000;
+  AHBPERIPH_BASE = PERIPH_BASE + $00020000;
+  AHB2PERIPH_BASE = PERIPH_BASE + $08000000;
+  TIM2_BASE    = APBPERIPH_BASE + $00000000;
+  TIM3_BASE    = APBPERIPH_BASE + $00000400;
+  TIM6_BASE    = APBPERIPH_BASE + $00001000;
+  TIM7_BASE    = APBPERIPH_BASE + $00001400;
+  TIM14_BASE   = APBPERIPH_BASE + $00002000;
+  RTC_BASE     = APBPERIPH_BASE + $00002800;
+  WWDG_BASE    = APBPERIPH_BASE + $00002C00;
+  IWDG_BASE    = APBPERIPH_BASE + $00003000;
+  SPI2_BASE    = APBPERIPH_BASE + $00003800;
+  USART2_BASE  = APBPERIPH_BASE + $00004400;
+  USART3_BASE  = APBPERIPH_BASE + $00004800;
+  USART4_BASE  = APBPERIPH_BASE + $00004C00;
+  USART5_BASE  = APBPERIPH_BASE + $00005000;
+  I2C1_BASE    = APBPERIPH_BASE + $00005400;
+  I2C2_BASE    = APBPERIPH_BASE + $00005800;
+  CAN_BASE     = APBPERIPH_BASE + $00006400;
+  CRS_BASE     = APBPERIPH_BASE + $00006C00;
+  PWR_BASE     = APBPERIPH_BASE + $00007000;
+  DAC_BASE     = APBPERIPH_BASE + $00007400;
+  CEC_BASE     = APBPERIPH_BASE + $00007800;
+  SYSCFG_BASE  = APBPERIPH_BASE + $00010000;
+  COMP_BASE    = APBPERIPH_BASE + $0001001C;
+  EXTI_BASE    = APBPERIPH_BASE + $00010400;
+  USART6_BASE  = APBPERIPH_BASE + $00011400;
+  USART7_BASE  = APBPERIPH_BASE + $00011800;
+  USART8_BASE  = APBPERIPH_BASE + $00011C00;
+  ADC1_BASE    = APBPERIPH_BASE + $00012400;
+  ADC_BASE     = APBPERIPH_BASE + $00012708;
+  TIM1_BASE    = APBPERIPH_BASE + $00012C00;
+  SPI1_BASE    = APBPERIPH_BASE + $00013000;
+  USART1_BASE  = APBPERIPH_BASE + $00013800;
+  TIM15_BASE   = APBPERIPH_BASE + $00014000;
+  TIM16_BASE   = APBPERIPH_BASE + $00014400;
+  TIM17_BASE   = APBPERIPH_BASE + $00014800;
+  DBGMCU_BASE  = APBPERIPH_BASE + $00015800;
+  DMA1_BASE    = AHBPERIPH_BASE + $00000000;
+  DMA1_Channel1_BASE = DMA1_BASE + $00000008;
+  DMA1_Channel2_BASE = DMA1_BASE + $0000001C;
+  DMA1_Channel3_BASE = DMA1_BASE + $00000030;
+  DMA1_Channel4_BASE = DMA1_BASE + $00000044;
+  DMA1_Channel5_BASE = DMA1_BASE + $00000058;
+  DMA1_Channel6_BASE = DMA1_BASE + $0000006C;
+  DMA1_Channel7_BASE = DMA1_BASE + $00000080;
+  DMA2_BASE    = AHBPERIPH_BASE + $00000400;
+  DMA2_Channel1_BASE = DMA2_BASE + $00000008;
+  DMA2_Channel2_BASE = DMA2_BASE + $0000001C;
+  DMA2_Channel3_BASE = DMA2_BASE + $00000030;
+  DMA2_Channel4_BASE = DMA2_BASE + $00000044;
+  DMA2_Channel5_BASE = DMA2_BASE + $00000058;
+  RCC_BASE     = AHBPERIPH_BASE + $00001000;
+  FLASH_R_BASE = AHBPERIPH_BASE + $00002000; // FLASH registers base address
+  OB_BASE      = $1FFFF800;           // FLASH Option Bytes base address
+  FLASHSIZE_BASE = $1FFFF7CC;         // FLASH Size register base address
+  UID_BASE     = $1FFFF7AC;           // Unique device ID register base address
+  CRC_BASE     = AHBPERIPH_BASE + $00003000;
+  TSC_BASE     = AHBPERIPH_BASE + $00004000;
+  GPIOA_BASE   = AHB2PERIPH_BASE + $00000000;
+  GPIOB_BASE   = AHB2PERIPH_BASE + $00000400;
+  GPIOC_BASE   = AHB2PERIPH_BASE + $00000800;
+  GPIOD_BASE   = AHB2PERIPH_BASE + $00000C00;
+  GPIOE_BASE   = AHB2PERIPH_BASE + $00001000;
+  GPIOF_BASE   = AHB2PERIPH_BASE + $00001400;
+
+var
+  TIM2         : TTIM_Registers absolute TIM2_BASE;
+  TIM3         : TTIM_Registers absolute TIM3_BASE;
+  TIM6         : TTIM_Registers absolute TIM6_BASE;
+  TIM7         : TTIM_Registers absolute TIM7_BASE;
+  TIM14        : TTIM_Registers absolute TIM14_BASE;
+  RTC          : TRTC_Registers absolute RTC_BASE;
+  WWDG         : TWWDG_Registers absolute WWDG_BASE;
+  IWDG         : TIWDG_Registers absolute IWDG_BASE;
+  USART2       : TUSART_Registers absolute USART2_BASE;
+  USART3       : TUSART_Registers absolute USART3_BASE;
+  USART4       : TUSART_Registers absolute USART4_BASE;
+  USART5       : TUSART_Registers absolute USART5_BASE;
+  I2C1         : TI2C_Registers absolute I2C1_BASE;
+  I2C2         : TI2C_Registers absolute I2C2_BASE;
+  CAN          : TCAN_Registers absolute CAN_BASE;
+  CRS          : TCRS_Registers absolute CRS_BASE;
+  PWR          : TPWR_Registers absolute PWR_BASE;
+  DAC1         : TDAC_Registers absolute DAC_BASE;
+  DAC          : TDAC_Registers absolute DAC_BASE; // Kept for legacy purpose
+  CEC          : TCEC_Registers absolute CEC_BASE;
+  SYSCFG       : TSYSCFG_Registers absolute SYSCFG_BASE;
+  COMP1        : TCOMP_Registers absolute COMP_BASE;
+  COMP2        : TCOMP_Registers absolute $00000002;
+  COMP12_COMMON : TCOMP_Common_Registers absolute COMP_BASE;
+  COMP         : TCOMP1_2_Registers absolute COMP_BASE; // Kept for legacy purpose
+  EXTI         : TEXTI_Registers absolute EXTI_BASE;
+  USART6       : TUSART_Registers absolute USART6_BASE;
+  USART7       : TUSART_Registers absolute USART7_BASE;
+  USART8       : TUSART_Registers absolute USART8_BASE;
+  ADC1         : TADC_Registers absolute ADC1_BASE;
+  ADC1_COMMON  : TADC_Common_Registers absolute ADC_BASE;
+  ADC          : TADC_Common_Registers absolute ADC_BASE; // Kept for legacy purpose
+  TIM1         : TTIM_Registers absolute TIM1_BASE;
+  SPI1         : TSPI_Registers absolute SPI1_BASE;
+  SPI2         : TSPI_Registers absolute SPI2_BASE;
+  USART1       : TUSART_Registers absolute USART1_BASE;
+  TIM15        : TTIM_Registers absolute TIM15_BASE;
+  TIM16        : TTIM_Registers absolute TIM16_BASE;
+  TIM17        : TTIM_Registers absolute TIM17_BASE;
+  DBGMCU       : TDBGMCU_Registers absolute DBGMCU_BASE;
+  DMA1         : TDMA_Registers absolute DMA1_BASE;
+  DMA1_Channel1 : TDMA_Channel_Registers absolute DMA1_Channel1_BASE;
+  DMA1_Channel2 : TDMA_Channel_Registers absolute DMA1_Channel2_BASE;
+  DMA1_Channel3 : TDMA_Channel_Registers absolute DMA1_Channel3_BASE;
+  DMA1_Channel4 : TDMA_Channel_Registers absolute DMA1_Channel4_BASE;
+  DMA1_Channel5 : TDMA_Channel_Registers absolute DMA1_Channel5_BASE;
+  DMA1_Channel6 : TDMA_Channel_Registers absolute DMA1_Channel6_BASE;
+  DMA1_Channel7 : TDMA_Channel_Registers absolute DMA1_Channel7_BASE;
+  DMA2         : TDMA_Registers absolute DMA2_BASE;
+  DMA2_Channel1 : TDMA_Channel_Registers absolute DMA2_Channel1_BASE;
+  DMA2_Channel2 : TDMA_Channel_Registers absolute DMA2_Channel2_BASE;
+  DMA2_Channel3 : TDMA_Channel_Registers absolute DMA2_Channel3_BASE;
+  DMA2_Channel4 : TDMA_Channel_Registers absolute DMA2_Channel4_BASE;
+  DMA2_Channel5 : TDMA_Channel_Registers absolute DMA2_Channel5_BASE;
+  FLASH        : TFLASH_Registers absolute FLASH_R_BASE;
+  OB           : TOB_Registers absolute OB_BASE;
+  RCC          : TRCC_Registers absolute RCC_BASE;
+  CRC          : TCRC_Registers absolute CRC_BASE;
+  TSC          : TTSC_Registers absolute TSC_BASE;
+  GPIOA        : TGPIO_Registers absolute GPIOA_BASE;
+  GPIOB        : TGPIO_Registers absolute GPIOB_BASE;
+  GPIOC        : TGPIO_Registers absolute GPIOC_BASE;
+  GPIOD        : TGPIO_Registers absolute GPIOD_BASE;
+  GPIOE        : TGPIO_Registers absolute GPIOE_BASE;
+  GPIOF        : TGPIO_Registers absolute GPIOF_BASE;
+
+implementation
+
+procedure NonMaskableInt_interrupt; external name 'NonMaskableInt_interrupt';
+procedure HardFault_interrupt; external name 'HardFault_interrupt';
+procedure SVC_interrupt; external name 'SVC_interrupt';
+procedure PendSV_interrupt; external name 'PendSV_interrupt';
+procedure SysTick_interrupt; external name 'SysTick_interrupt';
+procedure WWDG_interrupt; external name 'WWDG_interrupt';
+procedure VDDIO2_interrupt; external name 'VDDIO2_interrupt';
+procedure RTC_interrupt; external name 'RTC_interrupt';
+procedure FLASH_interrupt; external name 'FLASH_interrupt';
+procedure RCC_CRS_interrupt; external name 'RCC_CRS_interrupt';
+procedure EXTI0_1_interrupt; external name 'EXTI0_1_interrupt';
+procedure EXTI2_3_interrupt; external name 'EXTI2_3_interrupt';
+procedure EXTI4_15_interrupt; external name 'EXTI4_15_interrupt';
+procedure TSC_interrupt; external name 'TSC_interrupt';
+procedure DMA1_Ch1_interrupt; external name 'DMA1_Ch1_interrupt';
+procedure DMA1_Ch2_3_DMA2_Ch1_2_interrupt; external name 'DMA1_Ch2_3_DMA2_Ch1_2_interrupt';
+procedure DMA1_Ch4_7_DMA2_Ch3_5_interrupt; external name 'DMA1_Ch4_7_DMA2_Ch3_5_interrupt';
+procedure ADC1_COMP_interrupt; external name 'ADC1_COMP_interrupt';
+procedure TIM1_BRK_UP_TRG_COM_interrupt; external name 'TIM1_BRK_UP_TRG_COM_interrupt';
+procedure TIM1_CC_interrupt; external name 'TIM1_CC_interrupt';
+procedure TIM2_interrupt; external name 'TIM2_interrupt';
+procedure TIM3_interrupt; external name 'TIM3_interrupt';
+procedure TIM6_DAC_interrupt; external name 'TIM6_DAC_interrupt';
+procedure TIM7_interrupt; external name 'TIM7_interrupt';
+procedure TIM14_interrupt; external name 'TIM14_interrupt';
+procedure TIM15_interrupt; external name 'TIM15_interrupt';
+procedure TIM16_interrupt; external name 'TIM16_interrupt';
+procedure TIM17_interrupt; external name 'TIM17_interrupt';
+procedure I2C1_interrupt; external name 'I2C1_interrupt';
+procedure I2C2_interrupt; external name 'I2C2_interrupt';
+procedure SPI1_interrupt; external name 'SPI1_interrupt';
+procedure SPI2_interrupt; external name 'SPI2_interrupt';
+procedure USART1_interrupt; external name 'USART1_interrupt';
+procedure USART2_interrupt; external name 'USART2_interrupt';
+procedure USART3_8_interrupt; external name 'USART3_8_interrupt';
+procedure CEC_CAN_interrupt; external name 'CEC_CAN_interrupt';
+
+{$i cortexm0_start.inc}
+
+procedure Vectors; assembler; nostackframe;
+label interrupt_vectors;
+asm
+  .section ".init.interrupt_vectors"
+  interrupt_vectors:
+  .long _stack_top
+  .long Startup
+  .long NonMaskableInt_interrupt
+  .long HardFault_interrupt
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long 0
+  .long SVC_interrupt
+  .long 0
+  .long 0
+  .long PendSV_interrupt
+  .long SysTick_interrupt
+  .long WWDG_interrupt
+  .long VDDIO2_interrupt
+  .long RTC_interrupt
+  .long FLASH_interrupt
+  .long RCC_CRS_interrupt
+  .long EXTI0_1_interrupt
+  .long EXTI2_3_interrupt
+  .long EXTI4_15_interrupt
+  .long TSC_interrupt
+  .long DMA1_Ch1_interrupt
+  .long DMA1_Ch2_3_DMA2_Ch1_2_interrupt
+  .long DMA1_Ch4_7_DMA2_Ch3_5_interrupt
+  .long ADC1_COMP_interrupt
+  .long TIM1_BRK_UP_TRG_COM_interrupt
+  .long TIM1_CC_interrupt
+  .long TIM2_interrupt
+  .long TIM3_interrupt
+  .long TIM6_DAC_interrupt
+  .long TIM7_interrupt
+  .long TIM14_interrupt
+  .long TIM15_interrupt
+  .long TIM16_interrupt
+  .long TIM17_interrupt
+  .long I2C1_interrupt
+  .long I2C2_interrupt
+  .long SPI1_interrupt
+  .long SPI2_interrupt
+  .long USART1_interrupt
+  .long USART2_interrupt
+  .long USART3_8_interrupt
+  .long CEC_CAN_interrupt
+  .weak NonMaskableInt_interrupt
+  .weak HardFault_interrupt
+  .weak SVC_interrupt
+  .weak PendSV_interrupt
+  .weak SysTick_interrupt
+  .weak WWDG_interrupt
+  .weak VDDIO2_interrupt
+  .weak RTC_interrupt
+  .weak FLASH_interrupt
+  .weak RCC_CRS_interrupt
+  .weak EXTI0_1_interrupt
+  .weak EXTI2_3_interrupt
+  .weak EXTI4_15_interrupt
+  .weak TSC_interrupt
+  .weak DMA1_Ch1_interrupt
+  .weak DMA1_Ch2_3_DMA2_Ch1_2_interrupt
+  .weak DMA1_Ch4_7_DMA2_Ch3_5_interrupt
+  .weak ADC1_COMP_interrupt
+  .weak TIM1_BRK_UP_TRG_COM_interrupt
+  .weak TIM1_CC_interrupt
+  .weak TIM2_interrupt
+  .weak TIM3_interrupt
+  .weak TIM6_DAC_interrupt
+  .weak TIM7_interrupt
+  .weak TIM14_interrupt
+  .weak TIM15_interrupt
+  .weak TIM16_interrupt
+  .weak TIM17_interrupt
+  .weak I2C1_interrupt
+  .weak I2C2_interrupt
+  .weak SPI1_interrupt
+  .weak SPI2_interrupt
+  .weak USART1_interrupt
+  .weak USART2_interrupt
+  .weak USART3_8_interrupt
+  .weak CEC_CAN_interrupt
+  .set NonMaskableInt_interrupt, HaltProc
+  .set HardFault_interrupt, HaltProc
+  .set SVC_interrupt, HaltProc
+  .set PendSV_interrupt, HaltProc
+  .set SysTick_interrupt, HaltProc
+  .set WWDG_interrupt, HaltProc
+  .set VDDIO2_interrupt, HaltProc
+  .set RTC_interrupt, HaltProc
+  .set FLASH_interrupt, HaltProc
+  .set RCC_CRS_interrupt, HaltProc
+  .set EXTI0_1_interrupt, HaltProc
+  .set EXTI2_3_interrupt, HaltProc
+  .set EXTI4_15_interrupt, HaltProc
+  .set TSC_interrupt, HaltProc
+  .set DMA1_Ch1_interrupt, HaltProc
+  .set DMA1_Ch2_3_DMA2_Ch1_2_interrupt, HaltProc
+  .set DMA1_Ch4_7_DMA2_Ch3_5_interrupt, HaltProc
+  .set ADC1_COMP_interrupt, HaltProc
+  .set TIM1_BRK_UP_TRG_COM_interrupt, HaltProc
+  .set TIM1_CC_interrupt, HaltProc
+  .set TIM2_interrupt, HaltProc
+  .set TIM3_interrupt, HaltProc
+  .set TIM6_DAC_interrupt, HaltProc
+  .set TIM7_interrupt, HaltProc
+  .set TIM14_interrupt, HaltProc
+  .set TIM15_interrupt, HaltProc
+  .set TIM16_interrupt, HaltProc
+  .set TIM17_interrupt, HaltProc
+  .set I2C1_interrupt, HaltProc
+  .set I2C2_interrupt, HaltProc
+  .set SPI1_interrupt, HaltProc
+  .set SPI2_interrupt, HaltProc
+  .set USART1_interrupt, HaltProc
+  .set USART2_interrupt, HaltProc
+  .set USART3_8_interrupt, HaltProc
+  .set CEC_CAN_interrupt, HaltProc
+  .text
+end;
+end.
